# Create bar plot
us_sens_combined %>%
ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
geom_col(width = 0.8) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_fill_brewer(palette = "Set2") +
theme_bw() +
theme(legend.position = "none") +  # Removes the legend
geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
labs(
title = "US: Can __ be sensed?--Proportion of 'Yes' Responses by Question Type",
x = "Question Type",
y = "Proportion of 'Yes' Responses")
# Version 1 -- 35 participants
exist_bar(country = "Ghana", version = 1,
cols = c("sens_grm", "sens_dem", "sens_mug", "sens_frc", "sens_smn"),
col_names = c("sens_grm" = "Germs",
"sens_dem" = "Demons",
"sens_mug" = "Coffee Mugs",
"sens_frc" = "Force",
"sens_smn" = "Superman"),
title = "Ghana Version 1--Can __ be sensed?",
data = df_sens)
# Version 2 -- 35 participants
exist_bar(country = "Ghana", version = 2,
cols = c("sens_cnc", "sens_god", "sens_tbl", "sens_abs", "sens_kwk"),
col_names = c("sens_cnc" = "Cancer",
"sens_god" = "God",
"sens_tbl" = "Tables",
"sens_abs" = "Abosom (small god)",
"sens_kwk" = "Kweku Ananse (fic. char.)"),
title = "Ghana Version 2--Can __ be sensed?",
data = df_sens)
#----------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE
gh_sens_combined <- df_sens %>%
filter(ont_ctry_name == "Ghana") %>%
select(sens_grm, sens_dem, sens_mug, sens_frc, sens_smn,
sens_cnc, sens_god, sens_tbl, sens_abs, sens_kwk) %>%
mutate(across(everything(), as.numeric)) %>%
pivot_longer(everything(), names_to = "question", values_to = "response") %>%
mutate(
question_type = recode(question,
sens_grm = "Scientific",
sens_frc = "Scientific",
sens_cnc = "Scientific",
sens_mug = "Ordinary",
sens_tbl = "Ordinary",
sens_god = "Supernatural",
sens_dem = "Supernatural",
sens_abs = "Supernatural",
sens_kwk = "Fictional",
sens_smn = "Fictional")
) %>%
filter(!is.na(response)) %>%
group_by(question_type) %>%
summarise(
yes_count = sum(response == 1),
total_count = n(),
proportion_yes = yes_count / total_count
) %>%
arrange(desc(proportion_yes))  # Order by proportion
# Create bar plot
gh_sens_combined %>%
ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
geom_col(width = 0.8) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_fill_brewer(palette = "Set2") +
theme_bw() +
theme(legend.position = "none") +  # Removes the legend
geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
labs(
title = "Ghana: Can __ be sensed?--Proportion of 'Yes' Responses by Question Type",
x = "Question Type",
y = "Proportion of 'Yes' Responses")
# Version 1 -- 10 participants
exist_bar(country = "Ecuador_Amazon", version = 1,
cols = c("sens_flu", "sens_wen", "sens_mug", "sens_par", "sens_spd"),
col_names = c("sens_flu" = "Daicawo (flu)",
"sens_wen" = "Wene (demon/forest god)",
"sens_mug" = "Coffee Mugs",
"sens_par" = "Intestinal Parasites",
"sens_spd" = "Spiderman"),
title = "Ecuadorian Amazon Version 1--Can __ be sensed?",
data = df_sens)
# Version 2 -- 10 participants
exist_bar(country = "Ecuador_Amazon", version = 2,
cols = c("sens_cnc", "sens_god", "sens_tbl", "sens_okw", "sens_ram"),
col_names = c("sens_cnc" = "Cancer",
"sens_god" = "God",
"sens_tbl" = "Tables",
"sens_okw" = "Onokawa (ghost)",
"sens_ram" = "Rambo"),
title = "Ecuadorian Amazon Version 2--Can __ be sensed?",
data = df_sens)
#----------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE
ec_sens_combined <- df_sens %>%
filter(ont_ctry_name == "Ecuador_Amazon") %>%
select(sens_flu, sens_wen, sens_mug, sens_par, sens_spd,
sens_cnc, sens_god, sens_tbl, sens_okw, sens_ram) %>%
mutate(across(everything(), as.numeric)) %>%
pivot_longer(everything(), names_to = "question", values_to = "response") %>%
mutate(
question_type = recode(question,
sens_flu = "Scientific",
sens_par = "Scientific",
sens_cnc = "Scientific",
sens_mug = "Ordinary",
sens_tbl = "Ordinary",
sens_god = "Supernatural",
sens_wen = "Supernatural",
sens_okw = "Supernatural",
sens_spd = "Fictional",
sens_ram = "Fictional")
) %>%
filter(!is.na(response)) %>%
group_by(question_type) %>%
summarise(
yes_count = sum(response == 1),
total_count = n(),
proportion_yes = yes_count / total_count
) %>%
arrange(desc(proportion_yes))  # Order by proportion
# Create bar plot
ec_sens_combined %>%
ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
geom_col(width = 0.8) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_fill_brewer(palette = "Set2") +
theme_bw() +
theme(legend.position = "none") +  # Removes the legend
geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
labs(
title = "Ecuadorian Amazon:Can __ be sensed?--Proportion of 'Yes' Responses by Question Type",
x = "Question Type",
y = "Proportion of 'Yes' Responses")
# Version 1 -- 21 participants
exist_bar(country = "Peru_Amazon", version = 1,
cols = c("sens_ysh", "sens_par", "sens_god", "sens_tbl", "sens_njt", "sens_cha", "sens_cnc"),
col_names = c("sens_ysh" = "Mahua Yoshin\n(bad spirit)",
"sens_par" = "Intestinal Parasites",
"sens_god" = "God",
"sens_tbl" = "Tables",
"sens_njt" = "Ninja Turtles",
"sens_cha" = "Chaikoni\n(invisible magic humans)",
"sens_cnc" = "Cancer"),
title = "Peruvian Amazon Version 1--Can __ be sensed?",
data = df_sens)
# Version 2 -- 19 participants
exist_bar(country = "Peru_Amazon", version = 2,
cols = c("sens_grm", "sens_ron", "sens_taz", "sens_oni", "sens_smn", "sens_dlp"),
col_names = c("sens_grm" = "Germs",
"sens_ron" = "Ronin\n(Anaconda)",
"sens_taz" = "Coffee Mug",
"sens_oni" = "Oni Ibo\n(good spirit)",
"sens_smn" = "Superman",
"sens_dlp" = "Joshin Kokoshka\n(pink river dolphin)"),
title = "Peruvian Amazon Version 2--Can __ be sensed?",
data = df_sens)
#----------------------
# BOTH VERSIONS COMBINED
peru_sens_combined <- df_sens %>%
filter(ont_ctry_name == "Peru_Amazon") %>%
select(sens_ysh, sens_par, sens_god, sens_tbl, sens_njt, sens_cha, sens_cnc,
sens_grm, sens_ron, sens_taz, sens_oni, sens_smn, sens_dlp) %>%
mutate(across(everything(), as.numeric)) %>%
pivot_longer(everything(), names_to = "question", values_to = "response") %>%
mutate(
question_type = recode(question,
sens_par = "Scientific",
sens_cnc = "Scientific",
sens_grm = "Scientific",
sens_taz = "Ordinary",
sens_tbl = "Ordinary",
sens_ysh = "Supernatural",
sens_god = "Supernatural",
sens_cha = "Supernatural",
sens_ron = "Supernatural",
sens_oni = "Supernatural",
sens_dlp = "Supernatural",
sens_njt = "Fictional",
sens_smn = "Fictional")
) %>%
filter(!is.na(response)) %>%
group_by(question_type) %>%
summarise(
yes_count = sum(response == 1),
total_count = n(),
proportion_yes = yes_count / total_count
) %>%
arrange(desc(proportion_yes))  # Order by proportion
# Create bar plot
peru_sens_combined %>%
ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
geom_col(width = 0.8) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_fill_brewer(palette = "Set2") +
theme_bw() +
theme(legend.position = "none") +  # Removes the legend
geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
labs(
title = "Ecuadorian Amazon:Can __ be sensed?--Proportion of 'Yes' Responses by Question Type",
x = "Question Type",
y = "Proportion of 'Yes' Responses")
# Just version 1 questions--there are 21 participants
exist_bar(country = "US", version = 1,
cols = c("usens_grm", "usens_dem", "usens_mug", "usens_gvt", "usens_smn"),
col_names = c("usens_grm" = "Germs",
"usens_dem" = "Demons",
"usens_mug" = "Coffee Mugs",
"usens_gvt" = "Gravity",
"usens_smn" = "Superman"),
title = "US Version 1--Have you ever sensed __?",
data = df_usens)
# Version 2 -- 28 participants
exist_bar(country = "US", version = 2,
cols = c("usens_cnc", "usens_god", "usens_tbl", "usens_ghs", "usens_hap"),
col_names = c("usens_cnc" = "Cancer",
"usens_god" = "God",
"usens_tbl" = "Tables",
"usens_ghs" = "Ghosts",
"usens_hap" = "Harry Potter"),
title = "US Version 2--Have you ever sensed __?",
data = df_usens)
#-----------------------------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE
us_usens_combined <- df_usens %>%
filter(ont_ctry_name == "US") %>%
select(usens_grm, usens_dem, usens_mug, usens_gvt, usens_smn,
usens_cnc, usens_god, usens_tbl, usens_ghs, usens_hap) %>%
mutate(across(everything(), as.numeric)) %>%
pivot_longer(everything(), names_to = "question", values_to = "response") %>%
mutate(
question_type = recode(question,
usens_grm = "Scientific",
usens_gvt = "Scientific",
usens_cnc = "Scientific",
usens_mug = "Ordinary",
usens_tbl = "Ordinary",
usens_god = "Supernatural",
usens_dem = "Supernatural",
usens_ghs = "Supernatural",
usens_hap = "Fictional",
usens_smn = "Fictional")
) %>%
filter(!is.na(response)) %>%
group_by(question_type) %>%
summarise(
yes_count = sum(response == 1),
total_count = n(),
proportion_yes = yes_count / total_count
) %>%
arrange(desc(proportion_yes))  # Order by proportion
# Create bar plot
us_usens_combined %>%
ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
geom_col(width = 0.8) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_fill_brewer(palette = "Set2") +
theme_bw() +
theme(legend.position = "none") +  # Removes the legend
geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
labs(
title = "US: Have you ever sensed __?--Proportion of 'Yes' Responses by Question Type",
x = "Question Type",
y = "Proportion of 'Yes' Responses")
# Version 1 -- 35 participants
exist_bar(country = "Ghana", version = 1,
cols = c("usens_grm", "usens_dem", "usens_mug", "usens_frc", "usens_smn"),
col_names = c("usens_grm" = "Germs",
"usens_dem" = "Demons",
"usens_mug" = "Coffee Mugs",
"usens_frc" = "Force",
"usens_smn" = "Superman"),
title = "Ghana Version 1--Have you ever sensed __?",
data = df_usens)
# Version 2 -- 35 participants
exist_bar(country = "Ghana", version = 2,
cols = c("usens_cnc", "usens_god", "usens_tbl", "usens_abs", "usens_kwk"),
col_names = c("usens_cnc" = "Cancer",
"usens_god" = "God",
"usens_tbl" = "Tables",
"usens_abs" = "Abosom (small god)",
"usens_kwk" = "Kweku Ananse (fic. char.)"),
title = "Ghana Version 2--Have you ever sensed __?",
data = df_usens)
#----------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE
gh_usens_combined <- df_usens %>%
filter(ont_ctry_name == "Ghana") %>%
select(usens_grm, usens_dem, usens_mug, usens_frc, usens_smn,
usens_cnc, usens_god, usens_tbl, usens_abs, usens_kwk) %>%
mutate(across(everything(), as.numeric)) %>%
pivot_longer(everything(), names_to = "question", values_to = "response") %>%
mutate(
question_type = recode(question,
usens_grm = "Scientific",
usens_frc = "Scientific",
usens_cnc = "Scientific",
usens_mug = "Ordinary",
usens_tbl = "Ordinary",
usens_god = "Supernatural",
usens_dem = "Supernatural",
usens_abs = "Supernatural",
usens_kwk = "Fictional",
usens_smn = "Fictional")
) %>%
filter(!is.na(response)) %>%
group_by(question_type) %>%
summarise(
yes_count = sum(response == 1),
total_count = n(),
proportion_yes = yes_count / total_count
) %>%
arrange(desc(proportion_yes))  # Order by proportion
# Create bar plot
gh_usens_combined %>%
ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
geom_col(width = 0.8) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_fill_brewer(palette = "Set2") +
theme_bw() +
theme(legend.position = "none") +  # Removes the legend
geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
labs(
title = "Ghana: Have you ever sensed __?--Proportion of 'Yes' Responses by Question Type",
x = "Question Type",
y = "Proportion of 'Yes' Responses")
# Version 1 -- 10 participants
exist_bar(country = "Ecuador_Amazon", version = 1,
cols = c("usens_flu", "usens_wen", "usens_mug", "usens_par", "usens_spd"),
col_names = c("usens_flu" = "Daicawo (flu)",
"usens_wen" = "Wene (demon/forest god)",
"usens_mug" = "Coffee Mugs",
"usens_par" = "Intestinal Parasites",
"usens_spd" = "Spiderman"),
title = "Ecuadorian Amazon Version 1--Have you ever sensed __?",
data = df_usens)
# Version 2 -- 10 participants
exist_bar(country = "Ecuador_Amazon", version = 2,
cols = c("usens_cnc", "usens_god", "usens_tbl", "usens_okw", "usens_ram"),
col_names = c("usens_cnc" = "Cancer",
"usens_god" = "God",
"usens_tbl" = "Tables",
"usens_okw" = "Onokawa (ghost)",
"usens_ram" = "Rambo"),
title = "Ecuadorian Amazon Version 2--Have you ever sensed __?",
data = df_usens)
#----------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE
ec_usens_combined <- df_usens %>%
filter(ont_ctry_name == "Ecuador_Amazon") %>%
select(usens_flu, usens_wen, usens_mug, usens_par, usens_spd,
usens_cnc, usens_god, usens_tbl, usens_okw, usens_ram) %>%
mutate(across(everything(), as.numeric)) %>%
pivot_longer(everything(), names_to = "question", values_to = "response") %>%
mutate(
question_type = recode(question,
usens_flu = "Scientific",
usens_par = "Scientific",
usens_cnc = "Scientific",
usens_mug = "Ordinary",
usens_tbl = "Ordinary",
usens_god = "Supernatural",
usens_wen = "Supernatural",
usens_okw = "Supernatural",
usens_spd = "Fictional",
usens_ram = "Fictional")
) %>%
filter(!is.na(response)) %>%
group_by(question_type) %>%
summarise(
yes_count = sum(response == 1),
total_count = n(),
proportion_yes = yes_count / total_count
) %>%
arrange(desc(proportion_yes))  # Order by proportion
# Create bar plot
ec_usens_combined %>%
ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
geom_col(width = 0.8) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_fill_brewer(palette = "Set2") +
theme_bw() +
theme(legend.position = "none") +  # Removes the legend
geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
labs(
title = "Ecuadorian Amazon:Have you ever sensed __?--Proportion of 'Yes' Responses by Question Type",
x = "Question Type",
y = "Proportion of 'Yes' Responses")
# Version 1 -- 21 participants
exist_bar(country = "Peru_Amazon", version = 1,
cols = c("usens_ysh", "usens_par", "usens_god", "usens_tbl", "usens_njt", "usens_cha", "usens_cnc"),
col_names = c("usens_ysh" = "Mahua Yoshin\n(bad spirit)",
"usens_par" = "Intestinal Parasites",
"usens_god" = "God",
"usens_tbl" = "Tables",
"usens_njt" = "Ninja Turtles",
"usens_cha" = "Chaikoni\n(invisible magic humans)",
"usens_cnc" = "Cancer"),
title = "Peruvian Amazon Version 1--Have you ever sensed __?",
data = df_usens)
# Version 2 -- 19 participants
exist_bar(country = "Peru_Amazon", version = 2,
cols = c("usens_grm", "usens_ron", "usens_taz", "usens_oni", "usens_smn", "usens_dlp"),
col_names = c("usens_grm" = "Germs",
"usens_ron" = "Ronin\n(Anaconda)",
"usens_taz" = "Coffee Mug",
"usens_oni" = "Oni Ibo\n(good spirit)",
"usens_smn" = "Superman",
"usens_dlp" = "Joshin Kokoshka\n(pink river dolphin)"),
title = "Peruvian Amazon Version 2--Have you ever sensed __?",
data = df_usens)
#----------------------
# BOTH VERSIONS COMBINED
peru_usens_combined <- df_usens %>%
filter(ont_ctry_name == "Peru_Amazon") %>%
select(usens_ysh, usens_par, usens_god, usens_tbl, usens_njt, usens_cha, usens_cnc,
usens_grm, usens_ron, usens_taz, usens_oni, usens_smn, usens_dlp) %>%
mutate(across(everything(), as.numeric)) %>%
pivot_longer(everything(), names_to = "question", values_to = "response") %>%
mutate(
question_type = recode(question,
usens_par = "Scientific",
usens_cnc = "Scientific",
usens_grm = "Scientific",
usens_taz = "Ordinary",
usens_tbl = "Ordinary",
usens_ysh = "Supernatural",
usens_god = "Supernatural",
usens_cha = "Supernatural",
usens_ron = "Supernatural",
usens_oni = "Supernatural",
usens_dlp = "Supernatural",
usens_njt = "Fictional",
usens_smn = "Fictional")
) %>%
filter(!is.na(response)) %>%
group_by(question_type) %>%
summarise(
yes_count = sum(response == 1),
total_count = n(),
proportion_yes = yes_count / total_count
) %>%
arrange(desc(proportion_yes))  # Order by proportion
# Create bar plot
peru_usens_combined %>%
ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
geom_col(width = 0.8) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_fill_brewer(palette = "Set2") +
theme_bw() +
theme(legend.position = "none") +  # Removes the legend
geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
labs(
title = "Ecuadorian Amazon:Have you ever sensed __?--Proportion of 'Yes' Responses by Question Type",
x = "Question Type",
y = "Proportion of 'Yes' Responses")
knitr::opts_chunk$set(echo=F, warning=F, cache=F, message=F)
#loading packages
library(tidyverse)
library(readxl)
library(forcats)
library(RColorBrewer)
library(knitr)
library(kableExtra)
library(purrr)
library(lme4)
library(lmerTest)
library(emmeans)
library(gtsummary)
levels_type <- c("Ordinary", "Scientific", "Supernatural", "Fictional")
levels_country <- c("US", "Ghana", "Ecuador_Amazon", "Peru_Amazon")
#loading data
df_raw <- read_excel(path = "ontology_data.xlsx")
#making some modifications
df <- df_raw %>%
mutate(ont_ctry_name = case_when(
ont_ctry == 1 ~ "US",
ont_ctry == 4 ~ "Ghana",
ont_ctry == 7 ~ "Peru_Amazon",
ont_ctry == 6 ~ "Ecuador_Amazon",
TRUE ~ NA_character_
)) %>%
relocate(ont_ctry_name, .before = everything())
#cleanly loading in all custom functions to not clutter up this rmd file
source("./custom_functions.R")
#loading packages
library(tidyverse)
devtools::session_info()
sessionInfo()
packageVersion("tidyverse")
packageVersion("readxl")
packageVersion("forcats")
packageVersion("RColorBrewer")
packageVersion("knitr")
packageVersion("kableExtra")
packageVersion("purr")
packageVersion("purrr")
packageVersion("lme4")
packageVersion("lmerTest")
packageVersion("emmeans")
packageVersion("gtsummary")
