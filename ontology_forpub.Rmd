---
title: "Ontology_forpub"
author: "Eleanor Schille-Hudson"
date: "2025-07-30"
output: 
  html_document:
      toc: yes
      df_print: paged
      toc_float: yes
  html_notebook:
      code_folding: hide
      toc: yes
      toc_float: yes
---

# Set up 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=F, warning=F, cache=F, message=F)
```

```{r}
#loading packages
library(tidyverse)
library(readxl)
library(forcats)
library(RColorBrewer)
library(knitr)
library(kableExtra)
library(purrr)
library(lme4)
library(lmerTest)
library(emmeans)
library(gtsummary)

levels_type <- c("Ordinary", "Scientific", "Supernatural", "Fictional")
levels_country <- c("US", "Ghana", "Ecuador", "Peru")
```

```{r}
#loading data 
df_raw <- read_excel(path = "ontology_data.xlsx")
```

```{r}
#making some modifications

df <- df_raw %>%
  mutate(ont_ctry_name = case_when(
    ont_ctry == 1 ~ "US",
    ont_ctry == 4 ~ "Ghana",
    ont_ctry == 7 ~ "Peru",
    ont_ctry == 6 ~ "Ecuador",
    TRUE ~ NA_character_ 
  )) %>%
  relocate(ont_ctry_name, .before = everything())

```

```{r, include = F}
#cleanly loading in all custom functions to not clutter up this rmd file 
source("./custom_functions.R")
```

## Data Wrangling

```{r}
#df_sens requires sensory_vars, which is created in the custom_functions.R file

# Combine into one big df_sens
df_sens <- reduce(sensory_vars, left_join, by = "ont_subj")

# Rejoin metadata
df_sens <- df %>%
  select(ont_subj, ont_ctry_name, ont_version) %>%
  left_join(df_sens, by = "ont_subj")

# df_usens requires usens_vars, which is created in the custom_functions.R file

# Combine into one big df_sens
df_usens <- reduce(usens_vars, left_join, by = "ont_subj")

# Rejoin metadata
df_usens <- df %>%
  select(ont_subj, ont_ctry_name, ont_version) %>%
  left_join(df_usens, by = "ont_subj")
```

```{r}
# Note that this is the data frame in which many important variables are calculated, including the consensus score 
df_ext_long <- df %>% 
  filter(ont_ctry_name %in% c("US", "Ghana", "Ecuador", "Peru")) %>%
  select(ont_ctry_name, ont_subj,
         sci_ext_grm, spn_ext_dem, ord_ext_mug, sci_ext_frc, fic_ext_smn,
         sci_ext_cnc, spn_ext_god, ord_ext_tbl, spn_ext_abs, fic_ext_kwk,
         sci_ext_flu, spn_ext_wen, sci_ext_par, fic_ext_spd, spn_ext_okw, fic_ext_ram, 
         spn_ext_ysh, fic_ext_njt, spn_ext_cha, nas_ext_ron, ord_ext_taz, spn_ext_oni, nas_ext_dlp
         ) %>%
  mutate(across(c(-ont_ctry_name, -ont_subj), as.numeric)) %>%
  pivot_longer(c(-ont_ctry_name, -ont_subj), names_to = "question", values_to = "response") %>%
  mutate(
    response = ifelse(response == 99, 0.5, response),
    question_type = recode(question,
                           sci_ext_grm = "Scientific",
                           sci_ext_frc = "Scientific",
                           sci_ext_cnc = "Scientific",
                           sci_ext_flu = "Scientific",
                           sci_ext_par = "Scientific",
                           ord_ext_mug = "Ordinary",
                           ord_ext_tbl = "Ordinary",
                           ord_ext_taz = "Ordinary",
                           spn_ext_god = "Supernatural",
                           spn_ext_dem = "Supernatural",
                           spn_ext_wen = "Supernatural",
                           spn_ext_okw = "Supernatural",
                           spn_ext_abs = "Supernatural",
                           spn_ext_ysh = "Supernatural",
                           spn_ext_cha = "Supernatural",
                           nas_ext_ron = "Supernatural",
                           spn_ext_oni = "Supernatural", 
                           nas_ext_dlp = "Supernatural",
                           fic_ext_kwk = "Fictional",
                           fic_ext_smn = "Fictional",
                           fic_ext_spd = "Fictional",
                           fic_ext_ram = "Fictional", 
                           fic_ext_njt = "Fictional"), 
    
  ) %>%
  filter(!is.na(response)) %>% 
  group_by(ont_ctry_name, question) %>%
  mutate(consensus_excl_self = (sum(response, na.rm = TRUE) - response)/(n()-1),
         consensus = (sum(response, na.rm = TRUE)/n())) %>% 
  ungroup() %>% 
  mutate(item_code = str_extract(question, "[^_]+$")) #extracting final 3 characters

# making long usens df 
df_usens_long <- df_usens %>% 
  select(-ont_version) %>% 
  pivot_longer(c(-ont_ctry_name, -ont_subj), names_to = "usens_question", values_to = "usens_response") %>%
  filter(!is.na(usens_response)) %>% 
  mutate(item_code = str_extract(usens_question, "[^_]+$")) #extracting final 3 characters

# making long confidence df
df_conf_long <- df %>% 
  filter(ont_ctry_name %in% c("US", "Ghana", "Ecuador", "Peru")) %>%  
    select(ont_ctry_name, ont_subj,
           sci_conf.ext_grm, spn_conf.ext_dem, ord_conf.ext_mug, sci_conf.ext_gvt, fic_conf.ext_smn,
           sci_conf.ext_cnc, spn_conf.ext_god, ord_conf.ext_tbl, spn_conf.ext_ghs, fic_conf.ext_hap,  
           sci_conf.ext_grm, spn_conf.ext_dem, ord_conf.ext_mug, sci_conf.ext_frc, fic_conf.ext_smn,  
           sci_conf.ext_cnc, spn_conf.ext_god, ord_conf.ext_tbl, spn_conf.ext_abs, fic_conf.ext_kwk,  
           sci_conf.ext_flu, spn_conf.ext_wen, ord_conf.ext_mug, sci_conf.ext_par, fic_conf.ext_spd,  
           sci_conf.ext_cnc, spn_conf.ext_god, ord_conf.ext_tbl, spn_conf.ext_okw, fic_conf.ext_ram,  
           spn_conf.ext_ysh, sci_conf.ext_par, spn_conf.ext_god, ord_conf.ext_tbl,  
           fic_conf.ext_njt, spn_conf.ext_cha, sci_conf.ext_cnc,  
           sci_conf.ext_grm, nas_conf.ext_ron, ord_conf.ext_taz, spn_conf.ext_oni,  
           fic_conf.ext_smn, nas_conf.ext_dlp) %>%  
    mutate(across(-ont_ctry_name, as.numeric)) %>%
    pivot_longer(c(-ont_ctry_name, -ont_subj), names_to = "conf_question", values_to = "conf_response") %>%  
    filter(!is.na(conf_response)) %>%  
    mutate(category = recode(conf_question, 
                             sci_conf.ext_grm = "Scientific", 
                             sci_conf.ext_frc = "Scientific",  
                             sci_conf.ext_cnc = "Scientific",  
                             sci_conf.ext_flu = "Scientific",  
                             sci_conf.ext_par = "Scientific", 
                             sci_conf.ext_gvt = "Scientific",
                             ord_conf.ext_mug = "Ordinary",  
                             ord_conf.ext_tbl = "Ordinary",  
                             ord_conf.ext_taz = "Ordinary",  
                             spn_conf.ext_god = "Supernatural",  
                             spn_conf.ext_dem = "Supernatural", 
                             spn_conf.ext_wen = "Supernatural",  
                             spn_conf.ext_okw = "Supernatural",  
                             spn_conf.ext_abs = "Supernatural",  
                             spn_conf.ext_ysh = "Supernatural",  
                             spn_conf.ext_cha = "Supernatural",  
                             nas_conf.ext_ron = "Supernatural",  
                             spn_conf.ext_oni = "Supernatural",  
                             nas_conf.ext_dlp = "Supernatural", 
                             spn_conf.ext_ghs = "Supernatural", 
                             fic_conf.ext_kwk = "Fictional",  
                             fic_conf.ext_smn = "Fictional",  
                             fic_conf.ext_spd = "Fictional",  
                             fic_conf.ext_ram = "Fictional",  
                             fic_conf.ext_njt = "Fictional",
                             fic_conf.ext_hap = "Fictional"),
           ont_ctry_name = factor(ont_ctry_name, levels = levels_country),
           response_txt = recode(conf_response,  
                                 `0` = "Not sure",  
                                 `1` = "Somewhat sure",  
                                 `2` = "Pretty sure",  
                                 `3` = "Very sure")) %>% 
  mutate(item_code = str_extract(conf_question, "[^_]+$")) #extracting final 3 characters
```

```{r}
# joining into one dataframe
df_ext_usens_conf <- left_join(
  df_ext_long, df_usens_long, by = c("ont_ctry_name", "ont_subj", "item_code")
) %>% 
  left_join(df_conf_long, by = c("ont_ctry_name", "ont_subj", "item_code")) %>%
  mutate(item_code = as.factor(item_code), 
         question_type = factor(question_type, levels = levels_type), 
         ont_ctry_name = factor(ont_ctry_name, levels = levels_country)) #making this a factor so we can do ordinal regression
```

# Participant Demographics 

```{r}
# How many participants per country? 
xtabs(~ ont_ctry_name, data = df)

# Version of questions (version 1 or version 2) by country 
xtabs(~ ont_ctry_name + ont_version, data = df)
```

```{r}
#age
df %>% 
  mutate(ont_age = as.numeric(ont_age)) %>%
  group_by(ont_ctry_name) %>% 
  summarize(n = n(),
            mean_age = mean(ont_age, na.rm = T),
            med_age = median(ont_age, na.rm = T), 
            sd_age = sd(ont_age, na.rm = T), 
            range_age = paste0(min(ont_age, na.rm = T), " - ", max(ont_age, na.rm = T))) 

#sex male = 1
xtabs(~ ont_ctry_name + ont_sex, data = df)

#ethnicity 
xtabs(~ tolower(ont_ethn) + ont_ctry_name, data = df)

#education 
xtabs(~ tolower(ont_hied) + ont_ctry_name, data = df)

#"importance of god "God plays a very important role in my life (strongly disagree to strongly agree)
xtabs(~ ont_ctry_name + as.numeric(ont_imgd), data = df)

#church attendance
xtabs(~ tolower(ont_chfq) + ont_ctry_name, data = df)

# Do you think you are richer or poorer than most of the people in your community? (much poorer - much richer)
xtabs(~ ont_ctry_name + as.numeric(ont_ses), data = df)

# Do you feel you can afford to buy things you need, like clothing and shoes? (no/yes)
xtabs(~ ont_ctry_name + as.numeric(ont_affr), data = df)
```

# Figure 1, Accompanying Analyses & Appendix C regression results

The goal here is to combine confidence and existence scores. The confidence graph above shows people's confidence ratings regardless of whether they said the object existed or not. So, I will combine them this way:
- if they said it doesn't exist *-1
- if they said it does exist *1
- if they said they don't know *0 

This way, a person who said they don't know if it exists and a person who said it did or didn't but said they were "not sure" will both get a score of 0. A person who is "very sure" it doesn't exist will get a score of -3 and a person who is "very sure" it does exist will get a score of 3. 

```{r}
# making new column of existence response directions
df_ext_usens_conf <- df_ext_usens_conf %>% 
  mutate(ext_dir = case_when(
    response == 1 ~ 1,
    response == 0 ~ -1,
    response == 0.5 ~ 0,
    TRUE ~ response), 
    conf_dir = conf_response*ext_dir, 
    conf_dir_text = case_when(
      conf_dir == -3 ~ "Very sure doesn't exist",
      conf_dir == -2 ~ "Pretty sure doesn't exist",
      conf_dir == -1 ~ "Somewhat sure doesn't exist",
      conf_dir == 0 ~ "Not sure",
      conf_dir == 1 ~ "Somewhat sure exists",
      conf_dir == 2 ~ "Pretty sure exists",
      conf_dir == 3 ~ "Very sure exists"), 
    conf_dir_text = factor(conf_dir_text, 
                           levels = c("Very sure doesn't exist", "Pretty sure doesn't exist", "Somewhat sure doesn't exist", "Not sure", "Somewhat sure exists", "Pretty sure exists", "Very sure exists"))
    )
```

Graphing Figure 1

```{r, fig.width=15}
conf_colors <- (RColorBrewer::brewer.pal(7, "RdYlBu"))

# Create stacked bar plot  
df_ext_usens_conf %>% 
  filter(!is.na(conf_dir_text)) %>% 
  mutate(category = factor(category, levels = c("Ordinary", "Scientific", "Supernatural", "Fictional"))) %>%
  ggplot(aes(x = category, fill = conf_dir_text)) +  
  geom_bar(position = "fill") +  # Stacked proportions
  # geom_text(stat = "count", aes(label = after_stat(count)),
  #           position = position_fill(vjust = 0.5),
  #           size = 6, color = "white") +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) + 
  scale_fill_manual(values = conf_colors, drop = FALSE) + 
  theme_bw() +  
  labs(
    x = "Category of Objects",  
    y = "Proportion of Responses",  
    fill = "Confidence x Existence",  
    title = "Confidence x Existence by Category and Field Site"
  ) +
  theme(axis.text.x = element_text(size = 15, angle = -35, vjust = 1, hjust = 0),
        axis.title.x = element_text(size = 18),
        axis.title.y = element_text(size = 18),
        axis.text.y = element_text(size = 16),
        plot.title = element_text(size = 25), 
        strip.text.x = element_text(size = 18), 
        legend.text = element_text(size = 16), 
        legend.title = element_text(size =18)) +
  facet_wrap(~ ont_ctry_name, ncol = 4)   # Separate plots for each country
```


Models predicting confidence x existence scores by category with separate regressions for each country. The pairwise contrasts here showing ordinary vs. supernatural and scientific vs. supernatural are what make up Table 2. Full results are reported in Appendix C. 

```{r}
# 1 regression per country (4 total) where response is predicted by category

# US
m.us <- lmer(conf_dir ~ question_type + (1|ont_subj), data = filter(df_ext_usens_conf, ont_ctry_name == "US"))
summary(m.us)

##pairwise contrasts
emm.us <- emmeans(m.us, ~ question_type)
contrast(emm.us, method = "pairwise", adjust = "none")

# Ghana
m.ghana <- lmer(conf_dir ~ question_type + (1|ont_subj), data = filter(df_ext_usens_conf, ont_ctry_name == "Ghana"))
summary(m.ghana)

##pairwise contrasts
emm.ghana <- emmeans(m.ghana, ~ question_type)
contrast(emm.ghana, method = "pairwise", adjust = "none")

# Ecuador
m.ecuador <- lmer(conf_dir ~ question_type + (1|ont_subj), data = filter(df_ext_usens_conf, ont_ctry_name == "Ecuador"))
summary(m.ecuador)

##pairwise contrasts
emm.ecuador <- emmeans(m.ecuador, ~ question_type)
contrast(emm.ecuador, method = "pairwise", adjust = "none")

# Peru
m.peru <- lmer(conf_dir ~ question_type + (1|ont_subj), data = filter(df_ext_usens_conf, ont_ctry_name == "Peru"))
summary(m.peru)

##pairwise contrasts
emm.peru <- emmeans(m.peru, ~ question_type)
contrast(emm.peru, method = "pairwise", adjust = "none")

```

Model predicting confidence x existence scores by category pooling across non-US countries. These results show that when you combine all non-US country responses together, the difference between ordinary and supernatural confidence ratings are significant. 

```{r}
#combinging non us countries
m.non.us <- lmer(conf_dir ~ question_type + (1|ont_ctry_name/ont_subj), data = filter(df_ext_usens_conf, ont_ctry_name != "US"))
summary(m.non.us)

##pairwise contrasts
emm.non.us <- emmeans(m.non.us, ~ question_type)
contrast(emm.non.us, method = "pairwise", adjust = "none")
```

Model predicting confidence x existence scores by category, but only for highest contrast ordinary vs. supernatural items (coffee cups & tables vs. God & demons). These results show that these highest contrasts are significantly different in the US and Ghana, but not in Ecuador and Peru (in Ecuador, our smallest sample size, there are hints that this effect might be found in future similar studies). See Appendix A for full confidence and existence ratings broken down by item, version, and country. 

```{r}
# US --mugs, tables, god, demons
m.mug.us <- lmer(conf_dir ~ question_type + (1|ont_subj), data = df_ext_usens_conf %>% 
               filter(ont_ctry_name == "US",
                      item_code %in% c("mug", "tbl", "dem", "god")))
summary(m.mug.us)

# Ghana --mugs, tables, god, demons
m.mug.ghana <- lmer(conf_dir ~ question_type + (1|ont_subj), data = df_ext_usens_conf %>% 
               filter(ont_ctry_name == "Ghana",
                      item_code %in% c("mug", "tbl", "dem", "god")))
summary(m.mug.ghana)

# Ecuador --mugs, tables, god, Wene
m.mug.ecuador <- lmer(conf_dir ~ question_type + (1|ont_subj), data = df_ext_usens_conf %>% 
               filter(ont_ctry_name == "Ecuador",
                      item_code %in% c("mug", "tbl", "wen", "god"))) #Wene instead of demon
summary(m.mug.ecuador)

# Peru --mugs, tables, god, Oni Ibo 
m.mug.peru <- lmer(conf_dir ~ question_type + (1|ont_subj), data = df_ext_usens_conf %>% 
               filter(ont_ctry_name == "Peru",
                      item_code %in% c("taz", "tbl", "oni", "god")))
summary(m.mug.peru)
```

# Figure 2 & Accompanying Analyses

```{r, fig.width=15}
data_long_comm <- df %>%
  filter(ont_ctry_name %in% c("US", "Ghana", "Ecuador", "Peru")) %>%  
    select(ont_ctry_name, ont_subj,
           sci_comu_grm, spn_comu_dem, ord_comu_mug, sci_comu_gvt, fic_comu_smn,
           sci_comu_cnc, spn_comu_god, ord_comu_tbl, spn_comu_ghs, fic_comu_hap,  
           sci_comu_grm, spn_comu_dem, ord_comu_mug, sci_comu_frc, fic_comu_smn,  
           sci_comu_cnc, spn_comu_god, ord_comu_tbl, spn_comu_abs, fic_comu_kwk,  
           sci_comu_flu, spn_comu_wen, ord_comu_mug, sci_comu_par, fic_comu_spd,  
           sci_comu_cnc, spn_comu_god, ord_comu_tbl, spn_comu_okw, fic_comu_ram,  
           spn_comu_ysh, sci_comu_par, spn_comu_god, ord_comu_tbl,  
           fic_comu_njt, spn_comu_cha, sci_comu_cnc,  
           sci_comu_grm, nas_comu_ron, ord_comu_taz, spn_comu_oni,  
           fic_comu_smn, nas_comu_dlp) %>%  
    mutate(across(c(-ont_ctry_name, -ont_subj), as.numeric)) %>%
    pivot_longer(c(-ont_ctry_name, -ont_subj), names_to = "question", values_to = "response") %>%  
    mutate(response = ifelse(response == 99, 0.5, response)) %>%
    filter(!is.na(response)) %>%  
    mutate(category = recode(question, 
                             sci_comu_grm = "Scientific", 
                             sci_comu_frc = "Scientific",  
                             sci_comu_cnc = "Scientific",  
                             sci_comu_flu = "Scientific",  
                             sci_comu_par = "Scientific", 
                             sci_comu_gvt = "Scientific",
                             ord_comu_mug = "Ordinary",  
                             ord_comu_tbl = "Ordinary",  
                             ord_comu_taz = "Ordinary",  
                             spn_comu_god = "Supernatural",  
                             spn_comu_dem = "Supernatural", 
                             spn_comu_wen = "Supernatural",  
                             spn_comu_okw = "Supernatural",  
                             spn_comu_abs = "Supernatural",  
                             spn_comu_ysh = "Supernatural",  
                             spn_comu_cha = "Supernatural",  
                             nas_comu_ron = "Supernatural",  
                             spn_comu_oni = "Supernatural",  
                             nas_comu_dlp = "Supernatural", 
                             spn_comu_ghs = "Supernatural", 
                             fic_comu_kwk = "Fictional",  
                             fic_comu_smn = "Fictional",  
                             fic_comu_spd = "Fictional",  
                             fic_comu_ram = "Fictional",  
                             fic_comu_njt = "Fictional",
                             fic_comu_hap = "Fictional"),  
           response_txt = recode(response,
                                 `0` = "No",
                                 `1` = "Yes",
                                 `0.5` = "IDK"),
           response_txt = factor(response_txt, levels = c("No", "IDK", "Yes"))) %>%  
    filter(!is.na(category))  

  # Compute avg per category  
  cat_order <- data_long_comm %>%
    group_by(category) %>%
    summarise(m = mean(response))
     

  # Merge avg and reorder category  
  data_long_comm <- data_long_comm %>%  
    left_join(cat_order, by = "category") %>%  
    mutate(category = fct_reorder(category, m))
  
   conf_colors <- setNames(brewer.pal(3, "RdYlBu"), 
                           c("No", "IDK", "Yes"))
  
  # conf_colors <- setNames(c("#01665e","#5ab4ac","#8c510a"), 
  #                         c("Yes", "IDK", "No"))

  # Create stacked bar plot  
data_long_comm %>%
  mutate(category = factor(category, levels = c("Ordinary", "Scientific", "Supernatural", "Fictional")), 
         ont_ctry_name = factor(ont_ctry_name, levels = levels_country)) %>%
  ggplot(aes(x = category, fill = response_txt)) +  
  geom_bar(position = "fill") +  # Stacked proportions
  # geom_text(stat = "count", aes(label = after_stat(count)),   
  #           position = position_fill(vjust = 0.5),   
  #           size = 6, color = "white") +  
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) + 
  scale_fill_manual(values = conf_colors, drop = FALSE) + 
  theme_bw() +  
  labs(
    x = "Category of Objects",  
    y = "Proportion of Responses",  
    fill = "Responses",  
    title = "Can people communicate with __? by Category and Field Site"
  ) +
  theme(axis.text.x = element_text(size = 15, angle = -35, vjust = 1, hjust = 0),
        axis.title.x = element_text(size = 18),
        axis.title.y = element_text(size = 18),
        axis.text.y = element_text(size = 16),
        plot.title = element_text(size = 25), 
        strip.text.x = element_text(size = 18), 
        legend.text = element_text(size = 16), 
        legend.title = element_text(size =18)) +
  facet_wrap(~ ont_ctry_name, ncol = 4)   # Separate plots for each country


```

Models predicting "Can people communicate with X?" responses by category. The pairwise contrasts from these models are reported in the manuscript under the section "Additional Questions Reflect Differences in Epistemic Frames"

```{r}
# I want 1 regression per country (4 total) where response is predicted by category

# US
m.comm.us <- lmer(response ~ category + (1|ont_subj), data = filter(data_long_comm, ont_ctry_name == "US"))
summary(m.comm.us)

##pairwise contrasts
emm.comm.us <- emmeans(m.comm.us, ~ category)
contrast(emm.comm.us, method = "pairwise", adjust = "none")

# Ghana
m.comm.ghana <- lmer(response ~ category + (1|ont_subj), data = filter(data_long_comm, ont_ctry_name == "Ghana"))
summary(m.comm.ghana)

##pairwise contrasts
emm.comm.ghana <- emmeans(m.comm.ghana, ~ category)
contrast(emm.comm.ghana, method = "pairwise", adjust = "none")

# Ecuador
m.comm.ecuador <- lmer(response ~ category + (1|ont_subj), data = filter(data_long_comm, ont_ctry_name == "Ecuador"))
summary(m.comm.ecuador)

##pairwise contrasts
emm.comm.ecuador <- emmeans(m.comm.ecuador, ~ category)
contrast(emm.comm.ecuador, method = "pairwise", adjust = "none")

# Peru
m.comm.peru <- lmer(response ~ category + (1|ont_subj), data = filter(data_long_comm, ont_ctry_name == "Peru"))
summary(m.comm.peru)

##pairwise contrasts
emm.comm.peru <- emmeans(m.comm.peru, ~ category)
contrast(emm.comm.peru, method = "pairwise", adjust = "none")
```

# Figure 3 & Accompanying Analyses

```{r, fig.width=15}
data_long_spec <- df %>%
  filter(ont_ctry_name %in% c("US", "Ecuador", "Peru")) %>%  #question wasn't asked in ghana
    select(ont_ctry_name, ont_subj,
           sci_spexp_grm, spn_spexp_dem, ord_spexp_mug, sci_spexp_gvt, fic_spexp_smn,
           sci_spexp_cnc, spn_spexp_god, ord_spexp_tbl, spn_spexp_ghs, fic_spexp_hap,  
           # sci_spexp_grm, spn_spexp_dem, ord_spexp_mug, sci_spexp_frc, fic_spexp_smn,  
           # sci_spexp_cnc, spn_spexp_god, ord_spexp_tbl, spn_spexp_abs, fic_spexp_kwk,  
           sci_spexp_flu, spn_spexp_wen, ord_spexp_mug, sci_spexp_par, fic_spexp_spd,  
           sci_spexp_cnc, spn_spexp_god, ord_spexp_tbl, spn_spexp_okw, fic_spexp_ram,  
           spn_spexp_ysh, sci_spexp_par, spn_spexp_god, ord_spexp_tbl,  
           fic_spexp_njt, spn_spexp_cha, sci_spexp_cnc,  
           sci_spexp_grm, nas_spexp_ron, ord_spexp_taz, spn_spexp_oni,  
           fic_spexp_smn, nas_spexp_dlp) %>%  
    mutate(across(c(-ont_ctry_name, -ont_subj), as.numeric)) %>%
    pivot_longer(c(-ont_ctry_name, -ont_subj), names_to = "question", values_to = "response") %>%  
    mutate(response = ifelse(response == 99, 0.5, response)) %>%
    filter(!is.na(response)) %>%  
    mutate(category = recode(question, 
                             sci_spexp_grm = "Scientific", 
                             sci_spexp_frc = "Scientific",  
                             sci_spexp_cnc = "Scientific",  
                             sci_spexp_flu = "Scientific",  
                             sci_spexp_par = "Scientific", 
                             sci_spexp_gvt = "Scientific",
                             ord_spexp_mug = "Ordinary",  
                             ord_spexp_tbl = "Ordinary",  
                             ord_spexp_taz = "Ordinary",  
                             spn_spexp_god = "Supernatural",  
                             spn_spexp_dem = "Supernatural", 
                             spn_spexp_wen = "Supernatural",  
                             spn_spexp_okw = "Supernatural",  
                             spn_spexp_abs = "Supernatural",  
                             spn_spexp_ysh = "Supernatural",  
                             spn_spexp_cha = "Supernatural",  
                             nas_spexp_ron = "Supernatural",  
                             spn_spexp_oni = "Supernatural",  
                             nas_spexp_dlp = "Supernatural", 
                             spn_spexp_ghs = "Supernatural", 
                             fic_spexp_kwk = "Fictional",  
                             fic_spexp_smn = "Fictional",  
                             fic_spexp_spd = "Fictional",  
                             fic_spexp_ram = "Fictional",  
                             fic_spexp_njt = "Fictional",
                             fic_spexp_hap = "Fictional"),  
           response_txt = recode(response,
                                 `0` = "Anyone",
                                 `1` = "Only specific people",
                                 `0.5` = "IDK"),
           response_txt = factor(response_txt, levels = c("Anyone", "IDK", "Only specific people"))) %>%  
    filter(!is.na(category))  

  # Compute avg per category  
  cat_order <- data_long_spec %>%
    group_by(category) %>%
    summarise(m = mean(response))
     

  # Merge avg and reorder category  
  data_long_spec <- data_long_spec %>%  
    left_join(cat_order, by = "category") %>%  
    mutate(category = fct_reorder(category, m))
  
  conf_colors <- setNames(brewer.pal(3, "RdYlBu"), 
                           c("Anyone", "IDK", "Only specific people"))
  
  # conf_colors <- setNames(brewer.pal(3, "Set2"), 
  #                         c("Anyone", "IDK", "Only specific people"))

  # Create stacked bar plot  
data_long_spec %>%
  mutate(category = factor(category, levels = c("Ordinary", "Scientific", "Supernatural", "Fictional")), 
         ont_ctry_name = factor(ont_ctry_name, levels = levels_country)) %>%
  ggplot(aes(x = category, fill = response_txt)) +  
  geom_bar(position = "fill") +  # Stacked proportions
  # geom_text(stat = "count", aes(label = after_stat(count)),   
  #           position = position_fill(vjust = 0.5),   
  #           size = 6, color = "white") +  
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) + 
  scale_fill_manual(values = conf_colors, drop = FALSE) + 
  theme_bw() +  
  labs(
    x = "Category of Objects",  
    y = "Proportion of Responses",  
    fill = "Responses",  
    title = "Can __ be experienced by anyone or only by specific people?\nby Category and Field Site"
  ) +
  theme(axis.text.x = element_text(size = 15, angle = -35, vjust = 1, hjust = 0),
        axis.title.x = element_text(size = 18),
        axis.title.y = element_text(size = 18),
        axis.text.y = element_text(size = 16),
        plot.title = element_text(size = 25), 
        strip.text.x = element_text(size = 18), 
        legend.text = element_text(size = 16), 
        legend.title = element_text(size =18)) +
  facet_wrap(~ ont_ctry_name, ncol = 4)  # Separate plots for each country
```

Models predicting "Can X be experienced by anyone or only by specific people?" responses by category. The pairwise contrasts from these models are reported in the manuscript under the section "Additional Questions Reflect Differences in Epistemic Frames"

```{r}
# 1 regression per country (4 total) where response is predicted by category

# US
m.spec.us <- lmer(response ~ category + (1|ont_subj), data = filter(data_long_spec, ont_ctry_name == "US"))
summary(m.spec.us)

##pairwise contrasts
emm.spec.us <- emmeans(m.spec.us, ~ category)
contrast(emm.spec.us, method = "pairwise", adjust = "none")

# Ecuador
m.spec.ecuador <- lmer(response ~ category + (1|ont_subj), data = filter(data_long_spec, ont_ctry_name == "Ecuador"))
summary(m.spec.ecuador)

##pairwise contrasts
emm.spec.ecuador <- emmeans(m.spec.ecuador, ~ category)
contrast(emm.spec.ecuador, method = "pairwise", adjust = "none")

# Peru
m.spec.peru <- lmer(response ~ category + (1|ont_subj), data = filter(data_long_spec, ont_ctry_name == "Peru"))
summary(m.spec.peru)

##pairwise contrasts
emm.spec.peru <- emmeans(m.spec.peru, ~ category)
contrast(emm.spec.peru, method = "pairwise", adjust = "none")

```

# Figure 4 

Can __ be sensed? This combines across all sensory questions for each item. The items differed from country to country and version to version. But almost all contain the questions: see, hear, smell, touch, feel. Many but not all also had a taste question. 

```{r, fig.width=12}
# Combine all country data
combined_sens <- df_sens %>%
  filter(ont_ctry_name %in% c("US", "Ghana", "Ecuador", "Peru")) %>%
  select(ont_ctry_name, 
         sens_grm, sens_dem, sens_mug, sens_frc, sens_smn,
         sens_cnc, sens_god, sens_tbl, sens_abs, sens_kwk,
         sens_flu, sens_wen, sens_par, sens_spd, sens_okw, sens_ram, 
         sens_ysh, sens_njt, sens_cha, sens_ron, sens_taz, sens_oni, sens_dlp
         ) %>%
  mutate(across(-ont_ctry_name, as.numeric)) %>%
  pivot_longer(-ont_ctry_name, names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           sens_grm = "Scientific",
                           sens_frc = "Scientific",
                           sens_cnc = "Scientific",
                           sens_flu = "Scientific",
                           sens_par = "Scientific",
                           sens_mug = "Ordinary",
                           sens_tbl = "Ordinary",
                           sens_taz = "Ordinary",
                           sens_god = "Supernatural",
                           sens_dem = "Supernatural",
                           sens_wen = "Supernatural",
                           sens_okw = "Supernatural",
                           sens_abs = "Supernatural",
                           sens_ysh = "Supernatural",
                           sens_cha = "Supernatural",
                           sens_ron = "Supernatural",
                           sens_oni = "Supernatural", 
                           sens_dlp = "Supernatural",
                           sens_kwk = "Fictional",
                           sens_smn = "Fictional",
                           sens_spd = "Fictional",
                           sens_ram = "Fictional", 
                           sens_njt = "Fictional"), 
    question_type = factor(question_type, levels = levels_type), 
    ont_ctry_name = factor(ont_ctry_name, levels = levels_country)
  ) %>%
  filter(!is.na(response)) %>%
  group_by(ont_ctry_name, question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))

# Calculate overall proportions for sorting
overall_order <- combined_sens %>%
  group_by(question_type) %>%
  summarise(overall_proportion = sum(yes_count) / sum(total_count)) %>%
  arrange(desc(overall_proportion))

# Reorder combined data by overall proportion
combined_sens <- combined_sens %>%
  mutate(question_type = factor(question_type, 
                                levels = overall_order$question_type))


# Plot with reordered bars -- x axis is country
combined_sens %>%
  ggplot(aes(x = ont_ctry_name, y = proportion_yes, fill = question_type)) +
  geom_col(position = position_dodge(width = 0.8), width = 0.7) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2", name = "Question Type") +
  theme_bw() +
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),
            position = position_dodge(width = 0.8), vjust = 2, size = 4) +
  labs(
    title = "Can __ be sensed?: Proportion of 'Yes' Responses by Field Site",
    x = "Field Site",
    y = "Collated 'Yes' Responses to Sense Questions"
  ) + 
  theme(axis.text.x = element_text(size = 14),
        axis.title.x = element_text(size = 18),
        axis.text.y = element_text(size = 16),
        axis.title.y = element_text(size = 18),
        plot.title = element_text(size = 23), 
        strip.text.x = element_text(size = 17), 
        legend.text = element_text(size = 16), 
        legend.title = element_text(size =18))
```


# Figure 5 

```{r, fig.width=12}
# Combine all country data
combined_usens <- df_usens %>%
  filter(ont_ctry_name %in% c("US", "Ghana", "Ecuador", "Peru")) %>%
  select(ont_ctry_name, 
         usens_grm, usens_dem, usens_mug, usens_frc, usens_smn,
         usens_cnc, usens_god, usens_tbl, usens_abs, usens_kwk,
         usens_flu, usens_wen, usens_par, usens_spd, usens_okw, usens_ram, 
         usens_ysh, usens_njt, usens_cha, usens_ron, usens_taz, usens_oni, usens_dlp
         ) %>%
  mutate(across(-ont_ctry_name, as.numeric)) %>%
  pivot_longer(-ont_ctry_name, names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           usens_grm = "Scientific",
                           usens_frc = "Scientific",
                           usens_cnc = "Scientific",
                           usens_flu = "Scientific",
                           usens_par = "Scientific",
                           usens_mug = "Ordinary",
                           usens_tbl = "Ordinary",
                           usens_taz = "Ordinary",
                           usens_god = "Supernatural",
                           usens_dem = "Supernatural",
                           usens_wen = "Supernatural",
                           usens_okw = "Supernatural",
                           usens_abs = "Supernatural",
                           usens_ysh = "Supernatural",
                           usens_cha = "Supernatural",
                           usens_ron = "Supernatural",
                           usens_oni = "Supernatural", 
                           usens_dlp = "Supernatural",
                           usens_kwk = "Fictional",
                           usens_smn = "Fictional",
                           usens_spd = "Fictional",
                           usens_ram = "Fictional", 
                           usens_njt = "Fictional"),
    question_type = factor(question_type, levels = levels_type), 
    ont_ctry_name = factor(ont_ctry_name, levels = levels_country)
  ) %>%
  filter(!is.na(response)) %>%
  group_by(ont_ctry_name, question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))

# Calculate overall proportions for sorting
overall_order <- combined_usens %>%
  group_by(question_type) %>%
  summarise(overall_proportion = sum(yes_count) / sum(total_count)) %>%
  arrange(desc(overall_proportion))

# Reorder combined data by overall proportion
combined_usens <- combined_usens %>%
  mutate(question_type = factor(question_type, 
                                levels = overall_order$question_type))


# Plot with reordered bars -- x axis is country 
combined_usens %>%
  mutate(
    question_type = factor(question_type, levels = levels_type)) %>%
  ggplot(aes(x = ont_ctry_name, y = proportion_yes, fill = question_type)) +
  geom_col(position = position_dodge(width = 0.8), width = 0.7) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2", name = "Question Type") +
  theme_bw() +
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),
            position = position_dodge(width = 0.8), vjust = 2, size = 4) +
  labs(
    title = "Have you ever sensed __?: Proportion of 'Yes' Responses by Field Site",
    x = "Field Site",
    y = "Collated 'Yes' Responses to Sense Questions"
  ) + 
  theme(axis.text.x = element_text(size = 14),
        axis.title.x = element_text(size = 18),
        axis.text.y = element_text(size = 16),
        axis.title.y = element_text(size = 18),
        plot.title = element_text(size = 23), 
        strip.text.x = element_text(size = 17), 
        legend.text = element_text(size = 16), 
        legend.title = element_text(size =18))

```


# Table 3 & Accompanying Analyses

Models predicting confidence x existence scores with consensus and sensory experience scores. The results are reported in Table 3 in the manuscript

```{r}
# for more details on consensus score calculation, see the data frame where it is created in Data Wrangling 

m.conf <- lmer(conf_dir ~ consensus_excl_self + usens_response + (1 | ont_ctry_name/ont_subj), 
              data = df_ext_usens_conf)
summary(m.conf)

# making Table 3
m.conf %>% 
    tbl_regression(intercept = TRUE) %>% 
    as_gt() %>% 
    gt::tab_header(title = "Regression Results: Effects of Consensus and Sensory Evidence on Confidence")
```


# ALTERNATE CODING & FIG 1 et al

```{r}
df_ext_usens_conf_ALT <- df_ext_usens_conf %>% 
  mutate(ext_dir = case_when(
    response == 1 ~ 1,
    response == 0 ~ -1,
    response == 0.5 ~ 0,
    TRUE ~ response), 
    ext_label = case_when(
      ext_dir == 1 ~ "exist",
      ext_dir == -1 ~ "not", 
      ext_dir == 0 ~ "unsure"),
    conf_dir = case_when(
      ext_label == "exist" ~ ext_dir + conf_response,
      ext_label == "not" ~ ext_dir - conf_response,
      ext_label == "unsure" ~ 0),
    conf_dir_text = case_when(
      conf_dir == -4 ~ "Very sure doesn't exist",
      conf_dir == -3 ~ "Pretty sure doesn't exist",
      conf_dir == -2 ~ "Somewhat sure doesn't exist",
      conf_dir == -1 ~ "Not sure doesn't exist",
      conf_dir == 0 ~ "Not sure",
      conf_dir == 1 ~ "Not sure exists",
      conf_dir == 2 ~ "Somewhat sure exists",
      conf_dir == 3 ~ "Pretty sure exists",
      conf_dir == 4 ~ "Very sure exists"), 
    conf_dir_text = factor(conf_dir_text, 
                           levels = c("Very sure doesn't exist", "Pretty sure doesn't exist", "Somewhat sure doesn't exist", "Not sure doesn't exist", "Not sure", "Not sure exists", "Somewhat sure exists", "Pretty sure exists", "Very sure exists"))
  )
```

```{r, fig.width=15}
conf_colors <- (RColorBrewer::brewer.pal(9, "RdYlBu"))

# Create stacked bar plot  
df_ext_usens_conf_ALT %>% 
  filter(!is.na(conf_dir_text), !is.na(category)) %>% 
  mutate(category = factor(category, levels = c("Ordinary", "Scientific", "Supernatural", "Fictional"))) %>%
  ggplot(aes(x = category, fill = conf_dir_text)) +  
  geom_bar(position = "fill") +  # Stacked proportions
  # geom_text(stat = "count", aes(label = after_stat(count)),   
  #           position = position_fill(vjust = 0.5),   
  #           size = 6, color = "white") +  
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) + 
  scale_fill_manual(values = conf_colors, drop = FALSE) + 
  theme_bw() +  
  labs(
    x = "Category of Objects",  
    y = "Proportion of Responses",  
    fill = "Confidence x Existence",  
    title = "Confidence x Existence by Category and Country"
  ) +
  theme(axis.text.x = element_text(size = 15, angle = -35, vjust = 1, hjust = 0),
        axis.title.x = element_text(size = 18),
        axis.title.y = element_text(size = 18),
        axis.text.y = element_text(size = 16),
        plot.title = element_text(size = 25), 
        strip.text.x = element_text(size = 18), 
        legend.text = element_text(size = 16), 
        legend.title = element_text(size =18)) +
  facet_wrap(~ ont_ctry_name, ncol = 4)   # Separate plots for each country
```

```{r}
# 1 regression per country (4 total) where response is predicted by category

# US
m.us <- lmer(conf_dir ~ question_type + (1|ont_subj), data = filter(df_ext_usens_conf_ALT, ont_ctry_name == "US"))
summary(m.us)

##pairwise contrasts
emm.us <- emmeans(m.us, ~ question_type)
contrast(emm.us, method = "pairwise", adjust = "none")

# Ghana
m.ghana <- lmer(conf_dir ~ question_type + (1|ont_subj), data = filter(df_ext_usens_conf_ALT, ont_ctry_name == "Ghana"))
summary(m.ghana)

##pairwise contrasts
emm.ghana <- emmeans(m.ghana, ~ question_type)
contrast(emm.ghana, method = "pairwise", adjust = "none")

# Ecuador
m.ecuador <- lmer(conf_dir ~ question_type + (1|ont_subj), data = filter(df_ext_usens_conf_ALT, ont_ctry_name == "Ecuador"))
summary(m.ecuador)

##pairwise contrasts
emm.ecuador <- emmeans(m.ecuador, ~ question_type)
contrast(emm.ecuador, method = "pairwise", adjust = "none")

# Peru
m.peru <- lmer(conf_dir ~ question_type + (1|ont_subj), data = filter(df_ext_usens_conf_ALT, ont_ctry_name == "Peru"))
summary(m.peru)

##pairwise contrasts
emm.peru <- emmeans(m.peru, ~ question_type)
contrast(emm.peru, method = "pairwise", adjust = "none")

```

Model predicting confidence x existence scores by category pooling across non-US countries. These results show that when you combine all non-US country responses together, the difference between ordinary and supernatural confidence ratings are significant. 

```{r}
#combinging non us countries
m.non.us <- lmer(conf_dir ~ question_type + (1|ont_ctry_name/ont_subj), data = filter(df_ext_usens_conf_ALT, ont_ctry_name != "US"))
summary(m.non.us)

##pairwise contrasts
emm.non.us <- emmeans(m.non.us, ~ question_type)
contrast(emm.non.us, method = "pairwise", adjust = "none")
```

Model predicting confidence x existence scores by category, but only for highest contrast ordinary vs. supernatural items (coffee cups & tables vs. God & demons). These results show that these highest contrasts are significantly different in the US and Ghana, but not in Ecuador and Peru (in Ecuador, our smallest sample size, there are hints that this effect might be found in future similar studies). See Appendix A for full confidence and existence ratings broken down by item, version, and country. 

```{r}
# US --mugs, tables, god, demons
m.mug.us <- lmer(conf_dir ~ question_type + (1|ont_subj), data = df_ext_usens_conf_ALT %>% 
               filter(ont_ctry_name == "US",
                      item_code %in% c("mug", "tbl", "dem", "god")))
summary(m.mug.us)

# Ghana --mugs, tables, god, demons
m.mug.ghana <- lmer(conf_dir ~ question_type + (1|ont_subj), data = df_ext_usens_conf_ALT %>% 
               filter(ont_ctry_name == "Ghana",
                      item_code %in% c("mug", "tbl", "dem", "god")))
summary(m.mug.ghana)

# Ecuador --mugs, tables, god, Wene
m.mug.ecuador <- lmer(conf_dir ~ question_type + (1|ont_subj), data = df_ext_usens_conf_ALT %>% 
               filter(ont_ctry_name == "Ecuador",
                      item_code %in% c("mug", "tbl", "wen", "god"))) #Wene instead of demon
summary(m.mug.ecuador)

# Peru --mugs, tables, god, Oni Ibo 
m.mug.peru <- lmer(conf_dir ~ question_type + (1|ont_subj), data = df_ext_usens_conf_ALT %>% 
               filter(ont_ctry_name == "Peru",
                      item_code %in% c("taz", "tbl", "oni", "god")))
summary(m.mug.peru)
```

# Appendix A: Responses by object, version, and country

## Existence 

### US

```{r}
# Just version 1 questions--there are 21 participants
exist_bar(country = "US", version = 1, 
          cols = c("sci_ext_grm", "spn_ext_dem", "ord_ext_mug", "sci_ext_gvt", "fic_ext_smn"), 
          col_names = c("sci_ext_grm" = "Germs",
                           "spn_ext_dem" = "Demons",
                           "ord_ext_mug" = "Coffee Mugs",
                           "sci_ext_gvt" = "Gravity",
                           "fic_ext_smn" = "Superman"), 
          title = "US Version 1 responses to whether objects exist", 
          data = df)


# Version 2 -- 28 participants
exist_bar(country = "US", version = 2, 
          cols = c("sci_ext_cnc", "spn_ext_god", "ord_ext_tbl", "spn_ext_ghs", "fic_ext_hap"), 
          col_names = c("sci_ext_cnc" = "Cancer",
                           "spn_ext_god" = "God",
                           "ord_ext_tbl" = "Tables",
                           "spn_ext_ghs" = "Ghosts",
                           "fic_ext_hap" = "Harry Potter"), 
          title = "US Version 2 responses to whether objects exist", 
          data = df)

#-----------------------------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE 
us_data_combined <- df %>%
  filter(ont_ctry_name == "US") %>%
  select(sci_ext_grm, spn_ext_dem, ord_ext_mug, sci_ext_gvt, fic_ext_smn,
         sci_ext_cnc, spn_ext_god, ord_ext_tbl, spn_ext_ghs, fic_ext_hap) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           sci_ext_grm = "Scientific",
                           sci_ext_gvt = "Scientific",
                           sci_ext_cnc = "Scientific",
                           ord_ext_mug = "Ordinary",
                           ord_ext_tbl = "Ordinary",
                           spn_ext_god = "Supernatural",
                           spn_ext_dem = "Supernatural",
                           spn_ext_ghs = "Supernatural",
                           fic_ext_hap = "Fictional",
                           fic_ext_smn = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
us_data_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Add % and n
  labs(
    title = "US Ontology Questions--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses"
  )

```

### Ghana 

```{r}
# Version 1 -- 35 participants
exist_bar(country = "Ghana", version = 1, 
          cols = c("sci_ext_grm", "spn_ext_dem", "ord_ext_mug", "sci_ext_frc", "fic_ext_smn"), 
          col_names = c("sci_ext_grm" = "Germs",
                           "spn_ext_dem" = "Demons",
                           "ord_ext_mug" = "Coffee Mugs",
                           "sci_ext_frc" = "Force",
                           "fic_ext_smn" = "Superman"), 
          title = "Ghana Version 1 responses to whether objects exist", 
          data = df)

# Version 2 -- 35 participants
exist_bar(country = "Ghana", version = 2, 
          cols = c("sci_ext_cnc", "spn_ext_god", "ord_ext_tbl", "spn_ext_abs", "fic_ext_kwk"), 
          col_names = c("sci_ext_cnc" = "Cancer",
                           "spn_ext_god" = "God",
                           "ord_ext_tbl" = "Tables",
                           "spn_ext_abs" = "Abosom (small god)",
                           "fic_ext_kwk" = "Kweku Ananse (fic. char.)"), 
          title = "Ghana Version 2 responses to whether objects exist", 
          data = df)

#----------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE 
gh_data_combined <- df %>%
  filter(ont_ctry_name == "Ghana") %>%
  select(sci_ext_grm, spn_ext_dem, ord_ext_mug, sci_ext_frc, fic_ext_smn,
         sci_ext_cnc, spn_ext_god, ord_ext_tbl, spn_ext_abs, fic_ext_kwk) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           sci_ext_grm = "Scientific",
                           sci_ext_frc = "Scientific",
                           sci_ext_cnc = "Scientific",
                           ord_ext_mug = "Ordinary",
                           ord_ext_tbl = "Ordinary",
                           spn_ext_god = "Supernatural",
                           spn_ext_dem = "Supernatural",
                           spn_ext_abs = "Supernatural",
                           fic_ext_kwk = "Fictional",
                           fic_ext_smn = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
gh_data_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
  labs(
    title = "Ghana Ontology Questions--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses")
```

### Ecuador

```{r}
# Version 1 -- 10 participants 
exist_bar(country = "Ecuador", version = 1, 
          cols = c("sci_ext_flu", "spn_ext_wen", "ord_ext_mug", "sci_ext_par", "fic_ext_spd"), 
          col_names = c("sci_ext_flu" = "Daicawo (flu)",
                           "spn_ext_wen" = "Wene (demon/forest god)",
                           "ord_ext_mug" = "Coffee Mugs",
                           "sci_ext_par" = "Intestinal Parasites",
                           "fic_ext_spd" = "Spiderman"), 
          title = "Ecuadorian Amazon Version 1 responses to whether objects exist", 
          data = df)

# Version 2 -- 10 participants
exist_bar(country = "Ecuador", version = 2, 
          cols = c("sci_ext_cnc", "spn_ext_god", "ord_ext_tbl", "spn_ext_okw", "fic_ext_ram"), 
          col_names = c("sci_ext_cnc" = "Cancer",
                           "spn_ext_god" = "God",
                           "ord_ext_tbl" = "Tables",
                           "spn_ext_okw" = "Onokawa (ghost)",
                           "fic_ext_ram" = "Rambo"), 
          title = "Ecuadorian Amazon Version 2 responses to whether objects exist", 
          data = df)

#----------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE 
ec_data_combined <- df %>%
  filter(ont_ctry_name == "Ecuador") %>%
  select(sci_ext_flu, spn_ext_wen, ord_ext_mug, sci_ext_par, fic_ext_spd,
         sci_ext_cnc, spn_ext_god, ord_ext_tbl, spn_ext_okw, fic_ext_ram) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           sci_ext_flu = "Scientific",
                           sci_ext_par = "Scientific",
                           sci_ext_cnc = "Scientific",
                           ord_ext_mug = "Ordinary",
                           ord_ext_tbl = "Ordinary",
                           spn_ext_god = "Supernatural",
                           spn_ext_wen = "Supernatural",
                           spn_ext_okw = "Supernatural",
                           fic_ext_spd = "Fictional",
                           fic_ext_ram = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
ec_data_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
  labs(
    title = "Ecuadorian Amazon Ontology Questions--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses")
```

### Peru

```{r}
# Version 1 -- 21 participants
exist_bar(country = "Peru", version = 1, 
          cols = c("spn_ext_ysh", "sci_ext_par", "spn_ext_god", "ord_ext_tbl", "fic_ext_njt", "spn_ext_cha", "sci_ext_cnc"), 
          col_names = c("spn_ext_ysh" = "Mahua Yoshin\n(bad spirit)",  
                        "sci_ext_par" = "Intestinal Parasites",  
                        "spn_ext_god" = "God",  
                        "ord_ext_tbl" = "Tables",  
                        "fic_ext_njt" = "Ninja Turtles",  
                        "spn_ext_cha" = "Chaikoni\n(invisible magic humans)",  
                        "sci_ext_cnc" = "Cancer"), 
          title = "Peruvian Amazon Version 1 responses to whether objects exist", 
          data = df)


# Version 2 -- 19 participants
exist_bar(country = "Peru", version = 2, 
          cols = c("sci_ext_grm", "nas_ext_ron", "ord_ext_taz", "spn_ext_oni", "fic_ext_smn", "nas_ext_dlp"), 
          col_names = c("sci_ext_grm" = "Germs", 
                           "nas_ext_ron" = "Ronin\n(Anaconda)",
                           "ord_ext_taz" = "Coffee Mug",
                           "spn_ext_oni" = "Oni Ibo\n(good spirit)",
                           "fic_ext_smn" = "Superman",
                           "nas_ext_dlp" = "Joshin Kokoshka\n(pink river dolphin)"), 
          title = "Peruvian Amazon Version 2 responses to whether objects exist", 
          data = df)


#----------------------
# BOTH VERSIONS COMBINED

peru_data_combined <- df %>%
  filter(ont_ctry_name == "Peru") %>%
  select(spn_ext_ysh, sci_ext_par, spn_ext_god, ord_ext_tbl, fic_ext_njt, spn_ext_cha, sci_ext_cnc,
         sci_ext_grm, nas_ext_ron, ord_ext_taz, spn_ext_oni, fic_ext_smn, nas_ext_dlp) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           sci_ext_par = "Scientific",
                           sci_ext_cnc = "Scientific",
                           sci_ext_grm = "Scientific",
                           ord_ext_taz = "Ordinary",
                           ord_ext_tbl = "Ordinary",
                           spn_ext_ysh = "Supernatural",
                           spn_ext_god = "Supernatural",
                           spn_ext_cha = "Supernatural",
                           nas_ext_ron = "Supernatural",
                           spn_ext_oni = "Supernatural", 
                           nas_ext_dlp = "Supernatural",
                           fic_ext_njt = "Fictional",
                           fic_ext_smn = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
peru_data_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
  labs(
    title = "Peru Amazon Ontology Questions--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses")
```

## Confidence 

### US

```{r, fig.asp = 0.5}
# Version 1--21 participants
conf_bar_by_existence(
  country = "US",
  version = 1,
  conf_cols = c(
    "sci_conf.ext_grm", "spn_conf.ext_dem", "ord_conf.ext_mug", "sci_conf.ext_gvt", "fic_conf.ext_smn"
  ),
  exist_cols = c(
    "sci_ext_grm", "spn_ext_dem", "ord_ext_mug", "sci_ext_gvt", "fic_ext_smn"
  ),
  col_names = c(
    "sci_conf.ext_grm" = "Germs",
    "spn_conf.ext_dem" = "Demons",
    "ord_conf.ext_mug" = "Coffee Mugs",
    "sci_conf.ext_gvt" = "Gravity",
    "fic_conf.ext_smn" = "Superman"
  ),
  title = "US V1: Confidence by Belief"
)

# Version 2 -- 28 participants
conf_bar_by_existence(
  country = "US",
  version = 2,
  conf_cols = c(
    "sci_conf.ext_cnc", "spn_conf.ext_god", "ord_conf.ext_tbl", "spn_conf.ext_ghs", "fic_conf.ext_hap"
  ),
  exist_cols = c(
    "sci_ext_cnc", "spn_ext_god", "ord_ext_tbl", "spn_ext_ghs", "fic_ext_hap"
  ),
  col_names = c(
    "sci_conf.ext_cnc" = "Cancer",
    "spn_conf.ext_god" = "God",
    "ord_conf.ext_tbl" = "Tables",
    "spn_conf.ext_ghs" = "Ghosts",
    "fic_conf.ext_hap" = "Harry Potter"
  ),
  title = "US V2: Confidence by Belief"
)

```

### Ghana 

```{r, fig.asp = 0.5}
# Version 1 -- 35 participants
conf_bar_by_existence(
  country = "Ghana",
  version = 1,
  conf_cols = c(
    "sci_conf.ext_grm", "spn_conf.ext_dem", "ord_conf.ext_mug", "sci_conf.ext_frc", "fic_conf.ext_smn"
  ),
  exist_cols = c(
    "sci_ext_grm", "spn_ext_dem", "ord_ext_mug", "sci_ext_frc", "fic_ext_smn"
  ),
  col_names = c(
    "sci_conf.ext_grm" = "Germs",
    "spn_conf.ext_dem" = "Demons",
    "ord_conf.ext_mug" = "Coffee Mugs",
    "sci_conf.ext_frc" = "Force",
    "fic_conf.ext_smn" = "Superman"
  ),
  title = "Ghana V1: Confidence by Belief"
)

# Version 2 -- 35 participants
conf_bar_by_existence(
  country = "Ghana",
  version = 2,
  conf_cols = c(
    "sci_conf.ext_cnc", "spn_conf.ext_god", "ord_conf.ext_tbl", "spn_conf.ext_abs", "fic_conf.ext_kwk"
  ),
  exist_cols = c(
    "sci_ext_cnc", "spn_ext_god", "ord_ext_tbl", "spn_ext_abs", "fic_ext_kwk"
  ),
  col_names = c(
    "sci_conf.ext_cnc" = "Cancer",
    "spn_conf.ext_god" = "God",
    "ord_conf.ext_tbl" = "Tables",
    "spn_conf.ext_abs" = "Abosom\n(small god)",
    "fic_conf.ext_kwk" = "Kweku Ananse\n(fic. char.)"
  ),
  title = "Ghana V2: Confidence by Belief"
)

```

### Ecuador

```{r, fig.asp = 0.5}
# V1 10 participants 
conf_bar_by_existence(
  country = "Ecuador",
  version = 1,
  conf_cols = c(
    "sci_conf.ext_flu", "spn_conf.ext_wen", "ord_conf.ext_mug", "sci_conf.ext_par", "fic_conf.ext_spd"
  ),
  exist_cols = c(
    "sci_ext_flu", "spn_ext_wen", "ord_ext_mug", "sci_ext_par", "fic_ext_spd"
  ),
  col_names = c(
    "sci_conf.ext_flu" = "Daicawo (flu)",
    "spn_conf.ext_wen" = "Wene\n(demon/forest god)",
    "ord_conf.ext_mug" = "Coffee Mugs",
    "sci_conf.ext_par" = "Intestinal Parasites",
    "fic_conf.ext_spd" = "Spiderman"
  ),
  title = "Ecuadorian Amazon V1: Confidence by Belief"
)

# V2 10 participants
conf_bar_by_existence(
  country = "Ecuador",
  version = 2,
  conf_cols = c(
    "sci_conf.ext_cnc", "spn_conf.ext_god", "ord_conf.ext_tbl", "spn_conf.ext_okw", "fic_conf.ext_ram"
  ),
  exist_cols = c(
    "sci_ext_cnc", "spn_ext_god", "ord_ext_tbl", "spn_ext_okw", "fic_ext_ram"
  ),
  col_names = c(
    "sci_conf.ext_cnc" = "Cancer",
    "spn_conf.ext_god" = "God",
    "ord_conf.ext_tbl" = "Tables",
    "spn_conf.ext_okw" = "Onokawa\n(ghost)",
    "fic_conf.ext_ram" = "Rambo"
  ),
  title = "Ecuadorian Amazon V2: Confidence by Belief"
)

```

### Peru

```{r, fig.asp = 0.5}
# V1 -- 21 participants
conf_bar_by_existence(
  country = "Peru",
  version = 1,
  conf_cols = c(
    "spn_conf.ext_ysh", "sci_conf.ext_par", "spn_conf.ext_god", "ord_conf.ext_tbl", "fic_conf.ext_njt", 
    "spn_conf.ext_cha", "sci_conf.ext_cnc"
  ),
  exist_cols = c(
    "spn_ext_ysh", "sci_ext_par", "spn_ext_god", "ord_ext_tbl", "fic_ext_njt", "spn_ext_cha", "sci_ext_cnc"
  ),
  col_names = c(
    "spn_conf.ext_ysh" = "Mahua Yoshin\n(bad spirit)",
    "sci_conf.ext_par" = "Intestinal Parasites",
    "spn_conf.ext_god" = "God",
    "ord_conf.ext_tbl" = "Tables",
    "fic_conf.ext_njt" = "Ninja Turtles",
    "spn_conf.ext_cha" = "Chaikoni\n(invisible magic humans)",
    "sci_conf.ext_cnc" = "Cancer"
  ),
  title = "Peruvian Amazon V1: Confidence by Belief"
)


# V2 -- 19 participants
conf_bar_by_existence(
  country = "Peru",
  version = 2,
  conf_cols = c(
    "sci_conf.ext_grm", "nas_conf.ext_ron", "ord_conf.ext_taz", "spn_conf.ext_oni", "fic_conf.ext_smn", "nas_conf.ext_dlp"
  ),
  exist_cols = c(
    "sci_ext_grm", "nas_ext_ron", "ord_ext_taz", "spn_ext_oni", "fic_ext_smn", "nas_ext_dlp"
  ),
  col_names = c(
    "sci_conf.ext_grm" = "Germs",
    "nas_conf.ext_ron" = "Ronin\n(Anaconda)",
    "ord_conf.ext_taz" = "Coffee Mug",
    "spn_conf.ext_oni" = "Oni Ibo\n(good spirit)",
    "fic_conf.ext_smn" = "Superman",
    "nas_conf.ext_dlp" = "Joshin Kokoshka\n(pink river dolphin)"
  ),
  title = "Peruvian Amazon V2: Confidence by Belief"
)

```

## Communication 

### US

```{r}
yn_stacked_bar(country = "US", version = 1, 
                 cols = c("sci_comu_grm", "spn_comu_dem", "ord_comu_mug", "sci_comu_gvt", "fic_comu_smn"), 
                 col_names = c("sci_comu_grm" = "Germs",
                           "spn_comu_dem" = "Demons",
                           "ord_comu_mug" = "Coffee Mugs",
                           "sci_comu_gvt" = "Gravity",
                           "fic_comu_smn" = "Superman"), 
                 title = "US V1: Can people communicate with __?")

# Version 2 -- 28 participants
yn_stacked_bar(country = "US", version = 2, 
                 cols = c("sci_comu_cnc", "spn_comu_god", "ord_comu_tbl", "spn_comu_ghs", "fic_comu_hap"), 
                 col_names = c("sci_comu_cnc" = "Cancer",
                           "spn_comu_god" = "God",
                          "ord_comu_tbl" = "Tables",
                           "spn_comu_ghs" = "Ghosts",
                           "fic_comu_hap" = "Harry Potter"), 
                 title = "US V2: Can people communicate with __?")

# Both versions together
yn_by_category(country = "US", 
                 cols = c("sci_comu_grm", "spn_comu_dem", "ord_comu_mug", "sci_comu_gvt", "fic_comu_smn",
                          "sci_comu_cnc", "spn_comu_god", "ord_comu_tbl", "spn_comu_ghs", "fic_comu_hap"),
                 category_mapping = c("sci_comu_grm" = "Scientific",
                           "spn_comu_dem" = "Supernatural",
                           "ord_comu_mug" = "Ordinary",
                           "sci_comu_gvt" = "Scientific",
                           "fic_comu_smn" = "Fictional",
                           "sci_comu_cnc" = "Scientific",
                           "spn_comu_god" = "Supernatural",
                           "ord_comu_tbl" = "Ordinary",
                           "spn_comu_ghs" = "Supernatural",
                           "fic_comu_hap" = "Fictional"),
                 title = "US: Can people communicate with __?"
                 )
```

### Ghana 

```{r}
# Version 1 -- 35 participants by item and version
yn_stacked_bar(country = "Ghana", version = 1, 
                 cols = c("sci_comu_grm", "spn_comu_dem", "ord_comu_mug", "sci_comu_frc", "fic_comu_smn"), 
                 col_names = c("sci_comu_grm" = "Germs",
                           "spn_comu_dem" = "Demons",
                           "ord_comu_mug" = "Coffee Mugs",
                           "sci_comu_frc" = "Force",
                           "fic_comu_smn" = "Superman"), 
                 title = "Ghana V1: Can people communicate with __?")

# Version 2 -- 35 participants by item and version
yn_stacked_bar(country = "Ghana", version = 2, 
                 cols = c("sci_comu_cnc", "spn_comu_god", "ord_comu_tbl", "spn_comu_abs", "fic_comu_kwk"), 
                 col_names = c("sci_comu_cnc" = "Cancer",
                           "spn_comu_god" = "God",
                           "ord_comu_tbl" = "Tables",
                           "spn_comu_abs" = "Abosom\n(small god)",
                           "fic_comu_kwk" = "Kweku Ananse\n(fic. char.)"), 
                 title = "Ghana V2: Can people communicate with __?")

# Both versions together
yn_by_category(country = "Ghana", 
                 cols = c("sci_comu_grm", "spn_comu_dem", "ord_comu_mug", "sci_comu_frc", "fic_comu_smn",
                          "sci_comu_cnc", "spn_comu_god", "ord_comu_tbl", "spn_comu_abs", "fic_comu_kwk"),
                 category_mapping = c("sci_comu_grm" = "Scientific",
                           "spn_comu_dem" = "Supernatural",
                           "ord_comu_mug" = "Ordinary",
                           "sci_comu_frc" = "Scientific",
                           "fic_comu_smn" = "Fictional",
                           "sci_comu_cnc" = "Scientific",
                           "spn_comu_god" = "Supernatural",
                           "ord_comu_tbl" = "Ordinary",
                           "spn_comu_abs" = "Supernatural",
                           "fic_comu_kwk" = "Fictional"),
                 title = "Ghana: Can people communicate with __?"
                 )
```

### Ecuador

```{r}
# Version 1 -- 10 participants 
yn_stacked_bar(country = "Ecuador", version = 1, 
                 cols = c("sci_comu_flu", "spn_comu_wen", "ord_comu_mug", "sci_comu_par", "fic_comu_spd"), 
                 col_names = c("sci_comu_flu" = "Daicawo (flu)",
                           "spn_comu_wen" = "Wene\n(demon/forest god)",
                           "ord_comu_mug" = "Coffee Mugs",
                           "sci_comu_par" = "Intestinal Parasites",
                           "fic_comu_spd" = "Spiderman"), 
                 title = "Ecuadorian Amazon V1: Can people communicate with __?")

# Version 2 -- 10 participants
yn_stacked_bar(country = "Ecuador", version = 2, 
                 cols = c("sci_comu_cnc", "spn_comu_god", "ord_comu_tbl", "spn_comu_okw", "fic_comu_ram"), 
                 col_names = c("sci_comu_cnc" = "Cancer",
                           "spn_comu_god" = "God",
                           "ord_comu_tbl" = "Tables",
                           "spn_comu_okw" = "Onokawa\n(ghost)",
                           "fic_comu_ram" = "Rambo"), 
                 title = "Ecuadorian Amazon V2: Can people communicate with __?")

# Both versions together
yn_by_category(country = "Ecuador", 
                 cols = c("sci_comu_flu", "spn_comu_wen", "ord_comu_mug", "sci_comu_par", "fic_comu_spd",
                          "sci_comu_cnc", "spn_comu_god", "ord_comu_tbl", "spn_comu_okw", "fic_comu_ram"),
                 category_mapping = c("sci_comu_flu" = "Scientific",
                           "spn_comu_wen" = "Supernatural",
                           "ord_comu_mug" = "Ordinary",
                           "sci_comu_par" = "Scientific",
                           "fic_comu_spd" = "Fictional",
                           "sci_comu_cnc" = "Scientific",
                           "spn_comu_god" = "Supernatural",
                           "ord_comu_tbl" = "Ordinary",
                           "spn_comu_okw" = "Supernatural",
                           "fic_comu_ram" = "Fictional"),
                 title = "Ecuadorian Amazon: Can people communicate with __?"
                 )
```

### Peru

```{r}
# Version 1 -- 21 participants
yn_stacked_bar(country = "Peru", version = 1, 
                 cols = c("spn_comu_ysh", "sci_comu_par", "spn_comu_god", "ord_comu_tbl", 
                          "fic_comu_njt", "spn_comu_cha", "sci_comu_cnc"), 
                 col_names = c("spn_comu_ysh" = "Mahua Yoshin\n(bad spirit)",  
                        "sci_comu_par" = "Intestinal Parasites",  
                        "spn_comu_god" = "God",  
                        "ord_comu_tbl" = "Tables",  
                        "fic_comu_njt" = "Ninja Turtles",  
                        "spn_comu_cha" = "Chaikoni\n(invisible magic humans)",  
                        "sci_comu_cnc" = "Cancer"), 
                 title = "Peruvian Amazon V1: Can people communicate with __?")

# Version 2 -- 19 participants
yn_stacked_bar(country = "Peru", version = 2, 
                 cols = c("sci_comu_grm", "nas_comu_ron", "ord_comu_taz", "spn_comu_oni", 
                          "fic_comu_smn", "nas_comu_dlp"), 
                 col_names = c("sci_comu_grm" = "Germs", 
                           "nas_comu_ron" = "Ronin\n(Anaconda)",
                           "ord_comu_taz" = "Coffee Mug",
                           "spn_comu_oni" = "Oni Ibo\n(good spirit)",
                           "fic_comu_smn" = "Superman",
                           "nas_comu_dlp" = "Joshin Kokoshka\n(pink river dolphin)"), 
                 title = "Peruvian Amazon V2: Can people communicate with __?")

# Both versions together
yn_by_category(country = "Peru", 
                 cols = c("spn_comu_ysh", "sci_comu_par", "spn_comu_god", "ord_comu_tbl", 
                          "fic_comu_njt", "spn_comu_cha", "sci_comu_cnc",
                          "sci_comu_grm", "nas_comu_ron", "ord_comu_taz", "spn_comu_oni", 
                          "fic_comu_smn", "nas_comu_dlp"),
                 category_mapping = c("spn_comu_ysh" = "Supernatural",  
                        "sci_comu_par" = "Scientific",  
                        "spn_comu_god" = "Supernatural",  
                        "ord_comu_tbl" = "Ordinary",  
                        "fic_comu_njt" = "Fictional",  
                        "spn_comu_cha" = "Supernatural",  
                        "sci_comu_cnc" = "Scientific",
                        "sci_comu_grm" = "Scientific", 
                        "nas_comu_ron" = "Supernatural",
                        "ord_comu_taz" = "Ordinary",
                        "spn_comu_oni" = "Supernatural",
                        "fic_comu_smn" = "Fictional",
                        "nas_comu_dlp" = "Supernatural"),
                 title = "Peruvian Amazon: Can people communicate with __?"
                 )
```

## Special People 

### US

```{r}
spexp_stacked_bar(country = "US", version = 1, 
                 cols = c("sci_spexp_grm", "spn_spexp_dem", "ord_spexp_mug", "sci_spexp_gvt", "fic_spexp_smn"), 
                 col_names = c("sci_spexp_grm" = "Germs",
                           "spn_spexp_dem" = "Demons",
                           "ord_spexp_mug" = "Coffee Mugs",
                           "sci_spexp_gvt" = "Gravity",
                           "fic_spexp_smn" = "Superman"), 
                 title = "US V1: Can __ be experienced by anyone or only by specific people?")

# Version 2 -- 28 participants
spexp_stacked_bar(country = "US", version = 2, 
                 cols = c("sci_spexp_cnc", "spn_spexp_god", "ord_spexp_tbl", "spn_spexp_ghs", "fic_spexp_hap"), 
                 col_names = c("sci_spexp_cnc" = "Cancer",
                           "spn_spexp_god" = "God",
                          "ord_spexp_tbl" = "Tables",
                           "spn_spexp_ghs" = "Ghosts",
                           "fic_spexp_hap" = "Harry Potter"), 
                 title = "US V2: Can __ be experienced by anyone or only by specific people?")

# Both versions together
spexp_by_category(country = "US", 
                 cols = c("sci_spexp_grm", "spn_spexp_dem", "ord_spexp_mug", "sci_spexp_gvt", "fic_spexp_smn",
                          "sci_spexp_cnc", "spn_spexp_god", "ord_spexp_tbl", "spn_spexp_ghs", "fic_spexp_hap"),
                 category_mapping = c("sci_spexp_grm" = "Scientific",
                           "spn_spexp_dem" = "Supernatural",
                           "ord_spexp_mug" = "Ordinary",
                           "sci_spexp_gvt" = "Scientific",
                           "fic_spexp_smn" = "Fictional",
                           "sci_spexp_cnc" = "Scientific",
                           "spn_spexp_god" = "Supernatural",
                           "ord_spexp_tbl" = "Ordinary",
                           "spn_spexp_ghs" = "Supernatural",
                           "fic_spexp_hap" = "Fictional"),
                 title = "US: Can __ be experienced by anyone or only by specific people?"
                 )
```

### Ghana 

This question was not asked in Ghana

### Ecuador

```{r}
# Version 1 -- 10 participants 
spexp_stacked_bar(country = "Ecuador", version = 1, 
                 cols = c("sci_spexp_flu", "spn_spexp_wen", "ord_spexp_mug", "sci_spexp_par", "fic_spexp_spd"), 
                 col_names = c("sci_spexp_flu" = "Daicawo (flu)",
                           "spn_spexp_wen" = "Wene\n(demon/forest god)",
                           "ord_spexp_mug" = "Coffee Mugs",
                           "sci_spexp_par" = "Intestinal Parasites",
                           "fic_spexp_spd" = "Spiderman"), 
                 title = "Ecuadorian Amazon V1: Can __ be experienced by anyone or only by specific people?")

# Version 2 -- 10 participants
spexp_stacked_bar(country = "Ecuador", version = 2, 
                 cols = c("sci_spexp_cnc", "spn_spexp_god", "ord_spexp_tbl", "spn_spexp_okw", "fic_spexp_ram"), 
                 col_names = c("sci_spexp_cnc" = "Cancer",
                           "spn_spexp_god" = "God",
                           "ord_spexp_tbl" = "Tables",
                           "spn_spexp_okw" = "Onokawa\n(ghost)",
                           "fic_spexp_ram" = "Rambo"), 
                 title = "Ecuadorian Amazon V2: Can __ be experienced by anyone or only by specific people?")

# Both versions together
spexp_by_category(country = "Ecuador", 
                 cols = c("sci_spexp_flu", "spn_spexp_wen", "ord_spexp_mug", "sci_spexp_par", "fic_spexp_spd",
                          "sci_spexp_cnc", "spn_spexp_god", "ord_spexp_tbl", "spn_spexp_okw", "fic_spexp_ram"),
                 category_mapping = c("sci_spexp_flu" = "Scientific",
                           "spn_spexp_wen" = "Supernatural",
                           "ord_spexp_mug" = "Ordinary",
                           "sci_spexp_par" = "Scientific",
                           "fic_spexp_spd" = "Fictional",
                           "sci_spexp_cnc" = "Scientific",
                           "spn_spexp_god" = "Supernatural",
                           "ord_spexp_tbl" = "Ordinary",
                           "spn_spexp_okw" = "Supernatural",
                           "fic_spexp_ram" = "Fictional"),
                 title = "Ecuadorian Amazon: Can __ be experienced by anyone or only by specific people?"
                 )
```

### Peru

```{r}
# Version 1 -- 21 participants
spexp_stacked_bar(country = "Peru", version = 1, 
                 cols = c("spn_spexp_ysh", "sci_spexp_par", "spn_spexp_god", "ord_spexp_tbl", 
                          "fic_spexp_njt", "spn_spexp_cha", "sci_spexp_cnc"), 
                 col_names = c("spn_spexp_ysh" = "Mahua Yoshin\n(bad spirit)",  
                        "sci_spexp_par" = "Intestinal Parasites",  
                        "spn_spexp_god" = "God",  
                        "ord_spexp_tbl" = "Tables",  
                        "fic_spexp_njt" = "Ninja Turtles",  
                        "spn_spexp_cha" = "Chaikoni\n(invisible magic humans)",  
                        "sci_spexp_cnc" = "Cancer"), 
                 title = "Peruvian Amazon V1: Can __ be experienced by anyone or only by specific people?")

# Version 2 -- 19 participants
spexp_stacked_bar(country = "Peru", version = 2, 
                 cols = c("sci_spexp_grm", "nas_spexp_ron", "ord_spexp_taz", "spn_spexp_oni", 
                          "fic_spexp_smn", "nas_spexp_dlp"), 
                 col_names = c("sci_spexp_grm" = "Germs", 
                           "nas_spexp_ron" = "Ronin\n(Anaconda)",
                           "ord_spexp_taz" = "Coffee Mug",
                           "spn_spexp_oni" = "Oni Ibo\n(good spirit)",
                           "fic_spexp_smn" = "Superman",
                           "nas_spexp_dlp" = "Joshin Kokoshka\n(pink river dolphin)"), 
                 title = "Peruvian Amazon V2: Can __ be experienced by anyone or only by specific people?")

# Both versions together
spexp_by_category(country = "Peru", 
                 cols = c("spn_spexp_ysh", "sci_spexp_par", "spn_spexp_god", "ord_spexp_tbl", 
                          "fic_spexp_njt", "spn_spexp_cha", "sci_spexp_cnc",
                          "sci_spexp_grm", "nas_spexp_ron", "ord_spexp_taz", "spn_spexp_oni", 
                          "fic_spexp_smn", "nas_spexp_dlp"),
                 category_mapping = c("spn_spexp_ysh" = "Supernatural",  
                        "sci_spexp_par" = "Scientific",  
                        "spn_spexp_god" = "Supernatural",  
                        "ord_spexp_tbl" = "Ordinary",  
                        "fic_spexp_njt" = "Fictional",  
                        "spn_spexp_cha" = "Supernatural",  
                        "sci_spexp_cnc" = "Scientific",
                        "sci_spexp_grm" = "Scientific", 
                        "nas_spexp_ron" = "Supernatural",
                        "ord_spexp_taz" = "Ordinary",
                        "spn_spexp_oni" = "Supernatural",
                        "fic_spexp_smn" = "Fictional",
                        "nas_spexp_dlp" = "Supernatural"),
                 title = "Peruvian Amazon: Can __ be experienced by anyone or only by specific people?"
                 )
```

## Can X be sensed?

### US

```{r}
# Just version 1 questions--there are 21 participants
exist_bar(country = "US", version = 1, 
          cols = c("sens_grm", "sens_dem", "sens_mug", "sens_gvt", "sens_smn"), 
          col_names = c("sens_grm" = "Germs",
                           "sens_dem" = "Demons",
                           "sens_mug" = "Coffee Mugs",
                           "sens_gvt" = "Gravity",
                           "sens_smn" = "Superman"), 
          title = "US Version 1--Can __ be sensed?", 
          data = df_sens)


# Version 2 -- 28 participants
exist_bar(country = "US", version = 2, 
          cols = c("sens_cnc", "sens_god", "sens_tbl", "sens_ghs", "sens_hap"), 
          col_names = c("sens_cnc" = "Cancer",
                           "sens_god" = "God",
                           "sens_tbl" = "Tables",
                           "sens_ghs" = "Ghosts",
                           "sens_hap" = "Harry Potter"), 
          title = "US Version 2--Can __ be sensed?", 
          data = df_sens)

#-----------------------------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE 
us_sens_combined <- df_sens %>%
  filter(ont_ctry_name == "US") %>%
  select(sens_grm, sens_dem, sens_mug, sens_gvt, sens_smn,
         sens_cnc, sens_god, sens_tbl, sens_ghs, sens_hap) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           sens_grm = "Scientific",
                           sens_gvt = "Scientific",
                           sens_cnc = "Scientific",
                           sens_mug = "Ordinary",
                           sens_tbl = "Ordinary",
                           sens_god = "Supernatural",
                           sens_dem = "Supernatural",
                           sens_ghs = "Supernatural",
                           sens_hap = "Fictional",
                           sens_smn = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
us_sens_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
  labs(
    title = "US: Can __ be sensed?--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses")
```

### Ghana 

```{r}
# Version 1 -- 35 participants
exist_bar(country = "Ghana", version = 1, 
          cols = c("sens_grm", "sens_dem", "sens_mug", "sens_frc", "sens_smn"), 
          col_names = c("sens_grm" = "Germs",
                           "sens_dem" = "Demons",
                           "sens_mug" = "Coffee Mugs",
                           "sens_frc" = "Force",
                           "sens_smn" = "Superman"), 
          title = "Ghana Version 1--Can __ be sensed?", 
          data = df_sens)

# Version 2 -- 35 participants
exist_bar(country = "Ghana", version = 2, 
          cols = c("sens_cnc", "sens_god", "sens_tbl", "sens_abs", "sens_kwk"), 
          col_names = c("sens_cnc" = "Cancer",
                           "sens_god" = "God",
                           "sens_tbl" = "Tables",
                           "sens_abs" = "Abosom (small god)",
                           "sens_kwk" = "Kweku Ananse (fic. char.)"), 
          title = "Ghana Version 2--Can __ be sensed?", 
          data = df_sens)

#----------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE 
gh_sens_combined <- df_sens %>%
  filter(ont_ctry_name == "Ghana") %>%
  select(sens_grm, sens_dem, sens_mug, sens_frc, sens_smn,
         sens_cnc, sens_god, sens_tbl, sens_abs, sens_kwk) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           sens_grm = "Scientific",
                           sens_frc = "Scientific",
                           sens_cnc = "Scientific",
                           sens_mug = "Ordinary",
                           sens_tbl = "Ordinary",
                           sens_god = "Supernatural",
                           sens_dem = "Supernatural",
                           sens_abs = "Supernatural",
                           sens_kwk = "Fictional",
                           sens_smn = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
gh_sens_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
  labs(
    title = "Ghana: Can __ be sensed?--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses")
```

### Ecuador

```{r}
# Version 1 -- 10 participants 
exist_bar(country = "Ecuador", version = 1, 
          cols = c("sens_flu", "sens_wen", "sens_mug", "sens_par", "sens_spd"), 
          col_names = c("sens_flu" = "Daicawo (flu)",
                           "sens_wen" = "Wene (demon/forest god)",
                           "sens_mug" = "Coffee Mugs",
                           "sens_par" = "Intestinal Parasites",
                           "sens_spd" = "Spiderman"), 
          title = "Ecuadorian Amazon Version 1--Can __ be sensed?", 
          data = df_sens)

# Version 2 -- 10 participants
exist_bar(country = "Ecuador", version = 2, 
          cols = c("sens_cnc", "sens_god", "sens_tbl", "sens_okw", "sens_ram"), 
          col_names = c("sens_cnc" = "Cancer",
                           "sens_god" = "God",
                           "sens_tbl" = "Tables",
                           "sens_okw" = "Onokawa (ghost)",
                           "sens_ram" = "Rambo"), 
          title = "Ecuadorian Amazon Version 2--Can __ be sensed?", 
          data = df_sens)

#----------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE 
ec_sens_combined <- df_sens %>%
  filter(ont_ctry_name == "Ecuador") %>%
  select(sens_flu, sens_wen, sens_mug, sens_par, sens_spd,
         sens_cnc, sens_god, sens_tbl, sens_okw, sens_ram) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           sens_flu = "Scientific",
                           sens_par = "Scientific",
                           sens_cnc = "Scientific",
                           sens_mug = "Ordinary",
                           sens_tbl = "Ordinary",
                           sens_god = "Supernatural",
                           sens_wen = "Supernatural",
                           sens_okw = "Supernatural",
                           sens_spd = "Fictional",
                           sens_ram = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
ec_sens_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
  labs(
    title = "Ecuadorian Amazon:Can __ be sensed?--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses")
```

### Peru

```{r}
# Version 1 -- 21 participants
exist_bar(country = "Peru", version = 1, 
          cols = c("sens_ysh", "sens_par", "sens_god", "sens_tbl", "sens_njt", "sens_cha", "sens_cnc"), 
          col_names = c("sens_ysh" = "Mahua Yoshin\n(bad spirit)",  
                        "sens_par" = "Intestinal Parasites",  
                        "sens_god" = "God",  
                        "sens_tbl" = "Tables",  
                        "sens_njt" = "Ninja Turtles",  
                        "sens_cha" = "Chaikoni\n(invisible magic humans)",  
                        "sens_cnc" = "Cancer"), 
          title = "Peruvian Amazon Version 1--Can __ be sensed?", 
          data = df_sens)


# Version 2 -- 19 participants
exist_bar(country = "Peru", version = 2, 
          cols = c("sens_grm", "sens_ron", "sens_taz", "sens_oni", "sens_smn", "sens_dlp"), 
          col_names = c("sens_grm" = "Germs", 
                           "sens_ron" = "Ronin\n(Anaconda)",
                           "sens_taz" = "Coffee Mug",
                           "sens_oni" = "Oni Ibo\n(good spirit)",
                           "sens_smn" = "Superman",
                           "sens_dlp" = "Joshin Kokoshka\n(pink river dolphin)"), 
          title = "Peruvian Amazon Version 2--Can __ be sensed?", 
          data = df_sens)


#----------------------
# BOTH VERSIONS COMBINED

peru_sens_combined <- df_sens %>%
  filter(ont_ctry_name == "Peru") %>%
  select(sens_ysh, sens_par, sens_god, sens_tbl, sens_njt, sens_cha, sens_cnc,
         sens_grm, sens_ron, sens_taz, sens_oni, sens_smn, sens_dlp) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           sens_par = "Scientific",
                           sens_cnc = "Scientific",
                           sens_grm = "Scientific",
                           sens_taz = "Ordinary",
                           sens_tbl = "Ordinary",
                           sens_ysh = "Supernatural",
                           sens_god = "Supernatural",
                           sens_cha = "Supernatural",
                           sens_ron = "Supernatural",
                           sens_oni = "Supernatural", 
                           sens_dlp = "Supernatural",
                           sens_njt = "Fictional",
                           sens_smn = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
peru_sens_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
  labs(
    title = "Ecuadorian Amazon:Can __ be sensed?--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses")
```

## Have you ever sensed X? 

### US

```{r}
# Just version 1 questions--there are 21 participants
exist_bar(country = "US", version = 1, 
          cols = c("usens_grm", "usens_dem", "usens_mug", "usens_gvt", "usens_smn"), 
          col_names = c("usens_grm" = "Germs",
                           "usens_dem" = "Demons",
                           "usens_mug" = "Coffee Mugs",
                           "usens_gvt" = "Gravity",
                           "usens_smn" = "Superman"), 
          title = "US Version 1--Have you ever sensed __?", 
          data = df_usens)


# Version 2 -- 28 participants
exist_bar(country = "US", version = 2, 
          cols = c("usens_cnc", "usens_god", "usens_tbl", "usens_ghs", "usens_hap"), 
          col_names = c("usens_cnc" = "Cancer",
                           "usens_god" = "God",
                           "usens_tbl" = "Tables",
                           "usens_ghs" = "Ghosts",
                           "usens_hap" = "Harry Potter"), 
          title = "US Version 2--Have you ever sensed __?", 
          data = df_usens)

#-----------------------------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE 
us_usens_combined <- df_usens %>%
  filter(ont_ctry_name == "US") %>%
  select(usens_grm, usens_dem, usens_mug, usens_gvt, usens_smn,
         usens_cnc, usens_god, usens_tbl, usens_ghs, usens_hap) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           usens_grm = "Scientific",
                           usens_gvt = "Scientific",
                           usens_cnc = "Scientific",
                           usens_mug = "Ordinary",
                           usens_tbl = "Ordinary",
                           usens_god = "Supernatural",
                           usens_dem = "Supernatural",
                           usens_ghs = "Supernatural",
                           usens_hap = "Fictional",
                           usens_smn = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
us_usens_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
  labs(
    title = "US: Have you ever sensed __?--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses")
```

### Ghana 

```{r}
# Version 1 -- 35 participants
exist_bar(country = "Ghana", version = 1, 
          cols = c("usens_grm", "usens_dem", "usens_mug", "usens_frc", "usens_smn"), 
          col_names = c("usens_grm" = "Germs",
                           "usens_dem" = "Demons",
                           "usens_mug" = "Coffee Mugs",
                           "usens_frc" = "Force",
                           "usens_smn" = "Superman"), 
          title = "Ghana Version 1--Have you ever sensed __?", 
          data = df_usens)

# Version 2 -- 35 participants
exist_bar(country = "Ghana", version = 2, 
          cols = c("usens_cnc", "usens_god", "usens_tbl", "usens_abs", "usens_kwk"), 
          col_names = c("usens_cnc" = "Cancer",
                           "usens_god" = "God",
                           "usens_tbl" = "Tables",
                           "usens_abs" = "Abosom (small god)",
                           "usens_kwk" = "Kweku Ananse (fic. char.)"), 
          title = "Ghana Version 2--Have you ever sensed __?", 
          data = df_usens)

#----------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE 
gh_usens_combined <- df_usens %>%
  filter(ont_ctry_name == "Ghana") %>%
  select(usens_grm, usens_dem, usens_mug, usens_frc, usens_smn,
         usens_cnc, usens_god, usens_tbl, usens_abs, usens_kwk) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           usens_grm = "Scientific",
                           usens_frc = "Scientific",
                           usens_cnc = "Scientific",
                           usens_mug = "Ordinary",
                           usens_tbl = "Ordinary",
                           usens_god = "Supernatural",
                           usens_dem = "Supernatural",
                           usens_abs = "Supernatural",
                           usens_kwk = "Fictional",
                           usens_smn = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
gh_usens_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
  labs(
    title = "Ghana: Have you ever sensed __?--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses")
```

### Ecuador

```{r}
# Version 1 -- 10 participants 
exist_bar(country = "Ecuador", version = 1, 
          cols = c("usens_flu", "usens_wen", "usens_mug", "usens_par", "usens_spd"), 
          col_names = c("usens_flu" = "Daicawo (flu)",
                           "usens_wen" = "Wene (demon/forest god)",
                           "usens_mug" = "Coffee Mugs",
                           "usens_par" = "Intestinal Parasites",
                           "usens_spd" = "Spiderman"), 
          title = "Ecuadorian Amazon Version 1--Have you ever sensed __?", 
          data = df_usens)

# Version 2 -- 10 participants
exist_bar(country = "Ecuador", version = 2, 
          cols = c("usens_cnc", "usens_god", "usens_tbl", "usens_okw", "usens_ram"), 
          col_names = c("usens_cnc" = "Cancer",
                           "usens_god" = "God",
                           "usens_tbl" = "Tables",
                           "usens_okw" = "Onokawa (ghost)",
                           "usens_ram" = "Rambo"), 
          title = "Ecuadorian Amazon Version 2--Have you ever sensed __?", 
          data = df_usens)

#----------------------
## BOTH VERSIONS COMBINED BY QUESTION TYPE 
ec_usens_combined <- df_usens %>%
  filter(ont_ctry_name == "Ecuador") %>%
  select(usens_flu, usens_wen, usens_mug, usens_par, usens_spd,
         usens_cnc, usens_god, usens_tbl, usens_okw, usens_ram) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           usens_flu = "Scientific",
                           usens_par = "Scientific",
                           usens_cnc = "Scientific",
                           usens_mug = "Ordinary",
                           usens_tbl = "Ordinary",
                           usens_god = "Supernatural",
                           usens_wen = "Supernatural",
                           usens_okw = "Supernatural",
                           usens_spd = "Fictional",
                           usens_ram = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
ec_usens_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
  labs(
    title = "Ecuadorian Amazon:Have you ever sensed __?--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses")
```

### Peru

```{r}
# Version 1 -- 21 participants
exist_bar(country = "Peru", version = 1, 
          cols = c("usens_ysh", "usens_par", "usens_god", "usens_tbl", "usens_njt", "usens_cha", "usens_cnc"), 
          col_names = c("usens_ysh" = "Mahua Yoshin\n(bad spirit)",  
                        "usens_par" = "Intestinal Parasites",  
                        "usens_god" = "God",  
                        "usens_tbl" = "Tables",  
                        "usens_njt" = "Ninja Turtles",  
                        "usens_cha" = "Chaikoni\n(invisible magic humans)",  
                        "usens_cnc" = "Cancer"), 
          title = "Peruvian Amazon Version 1--Have you ever sensed __?", 
          data = df_usens)


# Version 2 -- 19 participants
exist_bar(country = "Peru", version = 2, 
          cols = c("usens_grm", "usens_ron", "usens_taz", "usens_oni", "usens_smn", "usens_dlp"), 
          col_names = c("usens_grm" = "Germs", 
                           "usens_ron" = "Ronin\n(Anaconda)",
                           "usens_taz" = "Coffee Mug",
                           "usens_oni" = "Oni Ibo\n(good spirit)",
                           "usens_smn" = "Superman",
                           "usens_dlp" = "Joshin Kokoshka\n(pink river dolphin)"), 
          title = "Peruvian Amazon Version 2--Have you ever sensed __?", 
          data = df_usens)


#----------------------
# BOTH VERSIONS COMBINED

peru_usens_combined <- df_usens %>%
  filter(ont_ctry_name == "Peru") %>%
  select(usens_ysh, usens_par, usens_god, usens_tbl, usens_njt, usens_cha, usens_cnc,
         usens_grm, usens_ron, usens_taz, usens_oni, usens_smn, usens_dlp) %>%
  mutate(across(everything(), as.numeric)) %>%
  pivot_longer(everything(), names_to = "question", values_to = "response") %>%
  mutate(
    question_type = recode(question,
                           usens_par = "Scientific",
                           usens_cnc = "Scientific",
                           usens_grm = "Scientific",
                           usens_taz = "Ordinary",
                           usens_tbl = "Ordinary",
                           usens_ysh = "Supernatural",
                           usens_god = "Supernatural",
                           usens_cha = "Supernatural",
                           usens_ron = "Supernatural",
                           usens_oni = "Supernatural", 
                           usens_dlp = "Supernatural",
                           usens_njt = "Fictional",
                           usens_smn = "Fictional")
  ) %>%
  filter(!is.na(response)) %>%
  group_by(question_type) %>%
  summarise(
    yes_count = sum(response == 1),
    total_count = n(),
    proportion_yes = yes_count / total_count
  ) %>%
  arrange(desc(proportion_yes))  # Order by proportion

# Create bar plot
peru_usens_combined %>%
  ggplot(aes(x = reorder(question_type, -proportion_yes), y = proportion_yes, fill = question_type)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_brewer(palette = "Set2") +
  theme_bw() +
  theme(legend.position = "none") +  # Removes the legend
  geom_text(aes(label = scales::percent(proportion_yes, accuracy = 1)),  # Add text on the bars
            position = position_stack(vjust = 0.5), color = "white", size = 5) +  # Adjust text appearance
  labs(
    title = "Ecuadorian Amazon:Have you ever sensed __?--Proportion of 'Yes' Responses by Question Type",
    x = "Question Type",
    y = "Proportion of 'Yes' Responses")
```